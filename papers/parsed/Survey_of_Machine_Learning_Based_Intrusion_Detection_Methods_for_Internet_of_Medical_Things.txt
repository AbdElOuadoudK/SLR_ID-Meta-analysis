Survey of Machine Learning Based Intrusion Detection Methods for Internet of Medical Things

The Internet of Medical Things (IoMT) has revolutionized the healthcare industry by enabling physiological data collection using sensors, which are transmitted to remote servers for continuous analysis by physicians and healthcare professionals. This technology offers numerous benefits, including early disease detection and automatic medication for patients with chronic illnesses. However, IoMT technology also presents significant security risks, such as violating patient privacy or exposing sensitive data to interception attacks due to wireless communication, which could be fatal for the patient. Additionally, traditional security measures, such as cryptography, are challenging to implement in medical equipment due to the heterogeneous communication and their limited computation, storage, and energy capacity. These protection methods are also ineffective against new and zero-day attacks. It is essential to adopt robust security measures to ensure data integrity, confidentiality, and availability during data collection, transmission, storage, and processing. In this context, using Intrusion Detection Systems (IDS) based on Machine Learning (ML) can bring a complementary security solution adapted to the unique characteristics of IoMT systems. Therefore, this paper investigates how IDS based on ML can address security and privacy issues in IoMT systems. First, the generic three-layer architecture of IoMT is provided, and the security requirements of IoMT systems are outlined. Then, the various threats that can affect IoMT security are identified, and the advantages, disadvantages, methods, and datasets used in each solution based on ML at the three layers that make up IoMT are presented. Finally, the paper discusses the challenges and limitations of applying IDS based on ML at each layer of IoMT, which can serve as a future research direction.

Introduction

The Internet of Things (IoT) represents the fourth industrial revolution, in which devices and systems are connected to enable communication and data exchange. The first three revolutions focused on agriculture, industry, and information technology. Kevin Ashton, a British technology pioneer, coined the term IoT in 1999 and defined it as a network of physical objects embedded with electronics, software, sensors, and network connectivity, allowing these objects to collect and exchange data, often using the internet . The use of sensors enables machine-to-machine communication, which allows for the exchange of data and information without the need for human intervention. This technology can potentially revolutionize various sectors, including healthcare, transportation, and manufacturing.

IoT is experiencing considerable development and is estimated to reach more than 24.1 billion devices worldwide in 2030, representing about four devices per person , which can be explained by the many possible applications that offer IoT. Among these applications is the Internet of Medical Things (IoMT). The IoMT uses sensors that are either wearable or implemented in the human body to collect health data. Then these data are sent to a remote server to be analyzed using Artificial Intelligence (AI) assisted by the physicians.

Healthcare has experienced many evolutions in digitalizing health data, as explained in (4) and summarized in this paragraph. The evolution of healthcare began in 1990 with the advent of what is now known as healthcare 1.0. This initial phase involved digitizing medical records, where doctors started entering patient notes into computers. These digital records were then managed and stored by specialized systems such as the Picture Archiving and Communication System and Radiology Information System. The introduction of Healthcare 2.0 saw hospitals adopting systems that integrate and manage the digital data stored on doctors' laptops. Then there was healthcare 3.0, which consists of compiling, and grouping all patient data into an Electronic Health Record (EHR), providing individuals with complete access to their health data and history. Healthcare 4.0 is currently underway, enabled by artificial intelligence, data provided by doctors, imaging centers, equipment, and sensors implemented or worn by patients. This evolution allows doctors and medical staff to make more accurate diagnoses and better treatment decisions and allows hospital managers to control costs.

The IoMT is a rapidly growing field leveraged in various health-related applications. One of its key advantages is its ability to provide real-time and continuous patient health monitoring. This technology has proven particularly effective in managing chronic conditions, such as diabetes, where insulin pumps can automatically inject insulin to regulate glucose levels. Similarly, pacemakers, which send electric shocks to the heart when an abnormality is detected, have been used to manage heart disease. Deep Brain Implants (DBI), another medical device enabled by the IoMT, provide electrical stimulation to the brain to treat neurological disorders like Parkinson's. Beyond treating specific conditions, the IoMT has been used for fall detection in older adults and performance measurement for athletes. In addition, it could improve access to healthcare in rural areas that lack medical infrastructure.

Moreover, the IoMT produces detailed and accurate medical data, increasing treatment efficiency, reducing medical errors, and identifying diseases in their early stages. This can lead to quicker treatment and improved patient outcomes. By transforming healthcare from curative to preventive, the quality of care for patients is significantly improved, and stakeholders like insurance companies and pharmacies benefit as well. Another advantage of IoMT is the remote access to medical data by nurses and patients' families, eliminating the need for regular hospital visits, reducing costs, saving hospital resources, and containing the spread of COVID-19. Additionally, patients can receive care in the comfort of their own home. Overall, the IoMT is a remarkable technological advancement that has the potential to significantly improve healthcare services, benefiting both patients and healthcare providers.

While the IoMT has the potential to revolutionize healthcare through real-time patient monitoring, its adoption faces significant barriers due to security and privacy risks. The use of wireless communication to transmit data from sensors to remote servers creates security vulnerabilities that compromise the data's confidentiality, integrity, and availability, with potentially fatal consequences for patients if incorrect treatments are administered. Several studies have demonstrated that even critical medical devices like Implantable Cardioverter-Defibrillators (ICD), DBIs, and insulin pumps can be hacked. Furthermore, because IoMT data is highly sensitive and personal, unauthorized access or disclosure could result in severe patient privacy violations. Such incidents have occurred in recent years, for example, the Singapore health service data breach that affected 1.5 million patients and the ransomware attack on a French hospital's system . Given these risks, it is essential to prioritize the security and privacy of IoMT data in order to ensure that patient safety is not compromised.

Securing IoMT presents unique challenges that traditional security methods cannot efficiently address. One such challenge is the low computational and storage capacity of IoMT sensors, which makes it difficult to apply resourceintensive security measures. In addition, designing a secure system for IoMT must consider caregivers' need for quick access during medical emergencies, as prompt response times can mean the difference between life and death. Moreover, the potential for third-party devices to control and upgrade IoMT equipment increases the risk of security breaches, necessitating the implementation of lightweight security solutions. However, since the attack vectors against IoMT systems constantly evolve, these solutions must be regularly revised and updated to ensure their efficacy against zero-day and new attacks.

The following advantages motivated our choice to investigate the use of ML for IoMT intrusion detection:

I Machine Learning can give intelligence to the IoMT system and be more suitable to their security requirements. Therefore, these methods can be more effective in emergencies than traditional access control methods. II IoMT and IoT systems generate a large amount of data that can be considered as big data due to their velocity, variety, and volume. These data are valuable sources for security because they can be used to learn normal behavior and detect abnormal behavior at an early stage, limiting the attack's damage. III Deep Learning (DL) algorithms can extract the relevant attributes to perform the classification automatically, which eliminates the necessary extraction process required in traditional ML methods and therefore offer an endto-end security model . IV ML methods can detect zero-day attacks and new vulnerabilities, which threat signature-based methods cannot.

In light of these different advantages that can offer the use of ML in a security application, this study investigates its application for the IoMT by answering the following questions:

A What is the generic architecture of an IoMT system, its security requirements, and the security threats that can affect it? B What are the different ML-based solutions proposed at the different layers of the IoMT? C What are the advantages and disadvantages of these different solutions? D What datasets are used to train and test the ML model at the different layers of IoMT?

The paper is divided into several sections to address the topic of IoMT security comprehensively. In Section 3, the different layers of IoMT architecture are described. Section 4 discusses the various requirements that are necessary to ensure IoMT security. Section 5 presents diverse threats that can undermine IoMT security, detailing the possible attacks that can affect each layer of the system, the types of attacks, attack environments, and the adversary's motivation to conduct an attack. The paper also highlights the significance of IDS in Section 6, while Section 7 presents an overview of the ML technique. Section 8 discusses the state-of-the-art approaches proposed in different layers of the system, highlighting the benefits, drawbacks, and datasets used in each solution. Section 9 sheds light on the limitations and challenges in using IDS based on ML for each layer of the IoMT system. Finally, the paper concludes in Section 10.

Figure shows the various components explored in this review paper. Table 2 List of abbreviations FPGA Field Programmable Gate Arrays Wi-Fi Wireless Fidelity CPU Central Processing Unit HFL Hierarchical Federated Learning RNN Recurrent Neural Network GRU Gated Recurrent Unit XAI Explainable AI

RELATED WORK

Many review articles address different aspects of security in an IoMT system and include ML to ensure security in these systems. To the best of our knowledge, most of them do not focus on using ML as a method to ensure security in IoMT, and they just mentioned it briefly. Table presents the different review papers that have discussed security in the IoMT, mentioning our main contribution compared with them.

H.Rathore, et al. explored issues, security risks relating to the privacy and safety of medical equipment, and solutions in , including anomaly detection based on ML.

M. reviewed different authentication schemes and classified them according to their type. They give advantages, disadvantages, and the ability to resist different attacks. They also categorized authentication mechanisms based on advanced methodologies, such as game theory and ML.

The work of M. covered a variety of malware attacks against IoMT systems, targeting security criteria, namely confidentiality, integrity, authenticity, and availability of data. The current security approach strategy has generally emphasized key management and intrusion detection using different methods such as ML, authentication, and access control.

In the work conducted by A.I. , they discussed security and privacy in healthcare by presenting a detailed survey of possible attacks, their impact, and solutions proposed in the literature, including solutions based on ML along with their limitations.

B.Narwal and A.K.Mohapatra in (13) presented a systematic survey on security and authentication in Wireless Body Area Networks (WBAN) to cover the main research elements. In particular, an in-depth classification of protection mechanisms in WBAN is provided along with a thorough analysis of security basics, threats to security, the intruder and their attack strategies, and current mitigation that include ML.

The survey presented by A. explained the IoMT ecosystem, reviewed the security requirement and vulnerability of IoMT systems, and presented recent security applications to protect this ecosystem, including blockchain, physically unclonable function and AI/ML.

Among the review papers conducted on security in IoMT, only a few survey papers have reported using ML as a method for security purposes in the literature. They describe it briefly and not in a holistic manner. However, a work similar to the current study conducted by S.S. discussed security and privacy in IoMT. They presented the different solutions based on ML proposed in the literature to solve the security challenge of IoMT, giving their advantage, disadvantage, approach, tools, and datasets used. However, the authors focused on network and device-level security and did not discuss the security of electronic medical data when it resides at the medical server level. This paper extends the previous work and discusses the various solutions used for anomaly detection based on ML at the medical device level, at transit, and during the resets by identifying the benefits, drawbacks, and datasets used. Reviewing the solutions at the three levels allow for discussing the ML method used to ensure the security and privacy of the IoMT globally.

Table 3 Existing Surveys Year paper Discussed topic(s) Main differences 2017 (9) Security of wireless medical devices

This survey provides the security and proposed solutions for the three layers composing the IoMT system 2019 Authentication in the wireless body area network

This survey presents the architecture, attacks on each layer that compose the IoMT, the environment, and the attackers' motivations. Then, the different ML-based solutions proposed for the layers forming the IoMT system are discussed 2019 Detection and prevention of malware in IoMT

This survey mentioned the attacks that can occur in each layer that composes IoMT, the types and environments of attacks, and the attackers' motivations, not only the malware. The IDS-based ML solutions proposed for the three layers that constitute the IoMT system are discussed in this survey and do not only cover the security of the communications 2020 Security and privacy in the healthcare system

The IDS-based ML solutions for the three layers of the IoMT system are provided 2021 Authentication in the wireless body area network

The different attacks occurring at the three layers composing the IoMT system are listed, and the solutions that use an IDS based on ML and proposed for the three layers of the IoMT system are discussed 2022 Review the use of new technologies to improve IoMT ecosystem security

The security requirements and threats for the three layers that compose the IoMT systems are provided. Then, the IDS solutions based on ML for each layer that forms the IoMT systems are reviewed, which allows identifying the limitations and challenges at each layer of the IoMT systems 2021

The role of ML in solving the security and privacy issue in IoMT systems

The different attacks that can impact the three layers of the IoMT and the IDS based on ML solutions proposed for layer three of the IoMT system are presented

ARCHITECTURE OF IoMT

Many architectures were presented in the literature. Some research proposes architectures composed of three layers . Other research proposes using an architecture with more than three layers . Different technologies are proposed to manage medical data, such as fog/cloud computing , Software-Defined Networking (SDN) , or Blockchain . This survey paper assumes that a three-layered architecture is suitable for logically dividing IoMT architecture. These layers are data acquisition, personal server, and medical server, and they are explained as follows and illustrated in figure .

Data Acquisition Layer

Sensor devices serve as a bridge between the human body and the digital world. There are four types of devices :

• The implemented devices: these devices are placed inside the human body, e.g., DBI.

• The wearable devices: these devices are on the human body e.g., Smartwatch, Pulse Generator (PG), or Electroencephalogram (EEG).

• The ambient devices: these devices allow capturing data from the environment around the patient, e.g., room temperature sensors.

• The stationary devices: these sensors are located in the hospital, e.g., imaging devices.

These devices are equipped with physiological sensors and low-power computing, connectivity, and storage modules, which are used to gather biomedical and context signals . The data collected are used to manage the treatment and diagnosis of patients' health conditions. These medical devices have other constraints at the internal and communication levels. Internally, the medical implants inside the human body can be rejected by the patient's immune system, resulting in inflammation and pain. The battery of these medical devices is limited and must be changed after a number of years. Traditional security methods such as cryptography can quickly shorten the implant's lifespan, which requires surgery to replace the battery and can be dangerous for the patient. Because of medical equipment's limited memory space, it is impossible to keep track of the exchanges made via log files. Regarding communication, medical equipment can only support short-range communication due to energy limitations . Due to scale, computing capacities, and energy constraints, most wearable devices can only preprocess the sensed data. Alternatively, the embedded low-power computing modules compress the sensed data before sending it to personal devices (i.e., smartphones or desktops) through low and ultra-low-power wireless communication like Near Field Communication (NFC) and Bluetooth Low Energy (BLE) .

Personal Server Layer

Medical equipment can send physiological data to personal servers like smartphones and laptops or standard devices like gateways . Personal servers process and save patient data remotely until it is sent to centralized medical servers. The medical data received at the personal server are saved and processed; for example, by adding contextual information such as place and time to detect unusual behavior, these data also can be encrypted or compressed. Then the processed data are sent in a medical standard format like Health Level-7 to the remote medical server using long-range wireless like Wireless Fidelity (Wi-Fi), Global System for Mobile Communications (GSM), or wired communication . This layer is intended to support heterogeneous communication and node mobility and permit the resending of medical data when the network link to the medical servers is interrupted .

Medical Server Layer

It consists of a high-performance data center that allows for centralized patient control, complex and long-term behavior analysis, and the correlation of patient data. It also includes a cloud server that makes intelligent decisions. It is used for data aggregation and provides extra patient medical data storage. The doctor, patients, and the pharmacy department (for summary or billing purposes) can access these data. Patients may use an online interface or smartphone to display their past and current health records/bills. Data from various sources are incorporated into EHR, Electronic Medical Records (EMR), or prescription websites. As a result, doctors and patients can access the information whenever needed. It provides a notification service for any patient who uploads or receives health data .

SECURITY REQUIREMENTS OF IoMT

IoMT uses wireless communication and the internet to transmit data collected from the human body to the medical server; therefore, the data in the different layers of the IoMT system, as shown in figure , are exposed to cyberattacks, which can impact the privacy of the patients and put their lives in danger. Security requirements must be met to prevent, detect and respond to these attacks in real time. This section presents the main security requirements of IoMT (Illustrated in figure ):

Confidentiality

This requirement ensures that the information regarding the patient's health condition or treatment and information that identifies them are not accessible by unauthorized third parties during data storage and data communication; this ensures that the patient's privacy is protected from the disclosure of sensitive information to persons with malicious intent who may cause considerable harm to the patient . It is possible to imagine a scenario in which an adversary, who has access to the medical history of a famous person, discloses it in public to impact his/her image.

Integrity

The data integrity provision for IoMT healthcare systems aims to ensure that the data arriving at the intended destination was not corrupted during wireless transmission. For instance, even a minor change to the medication or patient test results may have catastrophic implications for the patient's life. Preserving the integrity of information ensures that someone other than the person involved (i.e., doctors or nurses) does not change the medical data and, as a result, prohibits giving incorrect treatment .

Availability

Despite the implementation of healthcare, clinical records of patients must be available to the doctor at all times, anywhere, without any interruption. In addition, it is crucial to respond immediately to the emergency so that the doctor can give the patient treatment or precautions. Switching from the attacked node to another node in the network may be an alternative, and this redundancy can be allowed by the network and system design .

Freshness

This layer ensures that the health information is recent and that an attacker cannot replay old medical data. Two kinds of freshness are present; weak and strong freshness. Weak freshness gives the partial ordering of the health freshness message, and no delay information is provided. In contrast, strong freshness gives the complete ordering of the medical data and allows the calculation of delay . For illustration, a physician must be aware of the present patient's vital signs, such as their oxygen saturation, in order for the physician to make a correct diagnosis of the patient's health condition and provide the appropriate treatment.

Scalability

Scalability is the ability of the IoMT network to function properly; as the number of devices that compose the IoMT network turn to be larger, insufficient scalability could cause security flaws. Therefore, it is essential to manage overhead computing and storage, especially in an emergency where response time is vital for the patient .

Non-repudiation

Non-repudiation ensures that any entity involved in the healthcare application cannot deny the sending and receiving health-related patient information .

Authentication

There are two kinds of authentication in healthcare systems: data and persons. Data authentication is the process by which the initial data source is confirmed. Person authentication in communications between patients and related servers should be checked through accurate identity authentication. Therefore, before they communicate or exchange any details, all parties need to know each other. Before doing some form of sharing, the healthcare system has to recognize each participant to ensure that the user is authorized to receive the stored data. It is, therefore, essential to know the privilege level given to the user to know the kind of data he/she may access .

Authorization

Authorization is an access control used to specify permission levels for users (patients, physicians, or nurses) to enter the database of medical data. The healthcare organization must approve the patient and define the type of data that a single user can use .

Audit

The audit is the inspection of changes in the system and access to the patient's medical data via the verification of log files, which are historical records of the hardware and software operating status. The audit allows the detection of abnormal activities and possible breaches. However, the management and exploitation of this type of information are delicate in practice due to the large quantity and heterogeneity of logs generated by the various medical and network equipment.

Forward Secrecy

• Backward secrecy: Medical sensors who enter a network after a certain amount of time must not decode messages received before entering them .

• Forward secrecy: Medical sensors that have left the network are unable to read messages received after their exit (30).

IoMT SECURITY THREAT

The integration of wireless communication in the IoMT system and external equipment to control and upgrade sensors makes the IoMT vulnerable to different attacks. Moreover, two types of architecture are proposed in the literature for the IoMT: the single-hope and the multi-hope. For the single-hope, the sensors perform only data collection and transfer; however, this architecture suffers from the vulnerability of a single point of failure, which occurs when one equipment of the personal server layer fails, the whole IoMT system is compromised. The other type of architecture proposed is the multi-hope, here the sensors, in addition to collecting and transmitting data, also provide data routing, which allows node mobility and maintains low energy consumption during data transfer, like Codeblue and MIDiSN . Therefore, relevant vulnerabilities of the wireless sensors network that concern routing may apply to this type of architecture .

Attacks can indirectly target devices in the personal server layer to reach patient data. The lack of data storage security in the personal and medical servers and the insecure transmission of data between these different devices can cause various security issues .

It is imperative to keep these different attacks in mind when designing a secure architecture for IoMT. The different threats relateds to each level of IoMT are summarized in table 4. The most common types of network and system attacks are listed below:

Attack at Data Collection Level

During data perception and delivery over a wireless channel and the ability of medical equipment to be remotely configured by external devices led the medical sensors vulnerable to different attacks. Here are the potential security threats that could take place in the following manner:

Data Modification

An attacker modifies the medical data of patients to manipulate the medical diagnosis and lead to the administration of inappropriate medication, which can be dangerous for the patients.

Drain the Battery

Process that leads to additional battery consumption of a medical device, which leads to battery failure .

Modify the Software of the Device

An attacker can try to modify the software of the medical equipment by introducing a virus that modifies its behavior to conduct malicious actions , such as instructing the pacemaker to send an electrical charge to the patient's heart.

Jamming Attack

This attack interferes with the radio frequencies that the network's nodes use. A jamming source can interrupt the whole network or part of it. It may be deliberately or unintentionally made .

Node Tampering

In the case where an attacker has physical access to the IoMT nodes, they can gain access to the sensitive information on the node, for example, retrieve the encryption keys and then use them to decrypt the communications in transit. The attacker can even modify the node or replace it with a different node that the attacker controls .

Data Collision Attack

When two nodes of IoMT system transmit on the same frequency simultaneously, a collision may occur, which implies a modification of the transmitted data. Therefore, the receiving node of the packet will reject it due to the checksum mismatch .

Exhaustion

The collision implies that the packet lost is retransmitted; this retransmission consumes energy at the medical equipment level. The intruder could exploit the repeated collision to create resource exhaustion .

Unfairness in Allocation

Collision and exhaustion attacks can be used by the intruder to create unfairness in the network, Therefore, when incoming patient data packets enter the application's processing device, they are either missed or produce multiple errors .

Attack at the Transmission Level

There is a high risk of threat at the transmission level because wireless communication allows an attacker to intercept, modify, or block the messages sent and exchange valuable information related to the patient's condition. Some risks include:

Eavesdropping

Due to the communication over wireless networks, all traffic is vulnerable to detection and eavesdropping by attackers. These threats may result in the loss of personal information such as physiological data and may obtain information about the medical device, such as the type of medical equipment associated with the patient. They can also contribute to other kinds of attacks. There are two types of eavesdropping:

• Passive eavesdropping: By listening to the network's message transmission, a hacker will intercept the content .

• Active eavesdropping: By pretending to be a friendly entity and sending requests to emitters, a hacker actively obtains information .

Man In the Middle Attack

This attack happens when an intruder gets in between a patient and a server's communications and sniffs the data. They can capture all messages received between the two parties and insert new ones .

Scrambling Attacks

This attack keeps the radio frequency channel for wireless communication occupied for a brief period of time; this causes patients' personal devices to be interrupted to block data transfer, resulting in vulnerabilities of losing the network availability .

Signaling Attacks

In this threat, the attacker will try to disrupt the signaling operation that takes place before the establishment of a communication between two entities and involves key management, authentication, link creation, and registration by sending an additional signal, which will put a heavy load on the base station and thus interrupt its service. As a result, health data cannot be forwarded to their destination .

Message Modification Attack

By capturing patients' wireless channels, the attacker can extract health data from patients, which can then be partially or fully altered before being delivered back to the initial recipient .

Data Interception Attack

An attacker can capture a patient's health data when it is transmitted between two connected healthcare devices over a local area network .

Wormhole Attack

In this attack, a duplicate of a patient's data packet from one location is replayed at a different location with no modifications to the data. This attack usually requires two rogue nodes relaying packets over an out-of-bound channel that is only accessible by the attacker .

Denial of Service Attack (DoS)

In this attack, the intruder tries to interrupt, shut down, or stop a service from a system, machine, or a network. A distributed DoS (DDoS) attack, on the other hand, is a kind of DoS attack that originates from several distributed sources .

Hello Flood Attack

The attacker must persuade all nodes to choose them as the patient's medical data routing node. A malicious node accomplishes this by sending a HELLO packet over a strong radio transmission to the network. When a node receives a message like this, it will presume that the source is within a normal radio range. Such an assumption could be wrong, since the machine of the intruder with high transmission capability could mislead the target into assuming that it is his neighbor .

Sinkhole Attack

The sinkhole attack occurs when a malicious node attempts to attract all data packets in IoMT system by pretending that it is the most appropriate routing algorithm. This attack is performed to prevent data packets from reaching their destination .

Replaying Attack

In a replay attack, an attacker listens to communications received between valid entities in IoMT system, intercepts them, and then sends them again to an initial recipient to alter the overall result .

Homing Attack

A scan is performed in the continuous data traffic to find the key manager or the cluster head that can stop the whole network of IoMT system (49).

Data Flooding Attack

This attack occurs when an attacker sends many connection requests to a target node in the IoMT network. As a result, the server exhausts its capabilities and cannot establish any other connections, even legitimate ones .

Desynchronization Attack

The intruder repeatedly resends an incomplete message to one or both nodes that participate in communication within IoMT system, which requests the retransmission of the missing data. Consequently, valuable information is prevented from being exchanged between the endpoint (51).

Spoofing Attack

The attacker manipulates the routing information to compromise the network of IoMT system (52).

Selective Forwarding Attack

In this attack, the attacker will target a node in the IoMT network to compromise it and make it malicious, transmit some messages and block the rest. The number of messages lost will be more important if the compromised node is closer to the base station; therefore, many vital data will be wasted .

Sybil Attacks

A Sybil attack occurs when a given node in the IoMT network claims several identities to act (modify) geographical routing protocols (54).

Path DoS Attack

In this form of attack, the intruder produces a significant volume of traffic to the base station (51).

Overwhelming Sensors

In this threat, the intruder caused the network capacity dilapidation and node resource exhaustion by overwhelming the network node with sensor stimuli, causing the network to send a large amount of traffic to the base station .

Reprogramming Attacks

TinyOS' Deluge network-programming framework, for example, enables nodes in deployed networks to be remotely reprogrammed. The majority of these systems, like Deluge, are meant for use in a protected environment. A hacker will hijack the reprogramming mechanism and take possession of a vast network area if it is not secured (28).

Attack at Storage Level

All information related to the patient's health condition, treatment, and identity are stored at this level, which constitutes a valuable target for adversaries to access these data. Some of the possible attacks that can occur are:

Patient's Data Inference

Intruders try to recover medical records such as information about patient's health, maladies, and medications by combining information that the attacker is authorized to access with other pertinent information .

Unauthorized Access

If the patient data are not protected, the attacker will attempt to access health data to conduct a malicious action such as damage it or retrieve it; therefore, it is important to secure the data against unauthorized access (55).

Malware Attack

Malware (short for "malicious software") is a code or program usually spread over the network. It extracts, infects, or executes other malicious operations directed by the attacker. The types of malware include viruses, spyware, Keylogger, worm, rootkit, ransomware, and Trojan horses .

Social Engineering Attacks

Phishing, spear-phishing, baiting, and quid quo pro are examples of techniques to gain sensitive information from victims. These techniques are used to dupe the user into supplying the attacker with sensitive patient information that the user assumes to be supplied to someone or something else .

Location Threats

Most medical devices are equipped with a location component that allows the caregivers to have a quick response in an emergency. If this type of information is not well protected, adversaries can access it and directly invade a person's privacy .

Alert Attack

Some medical devices are equipped with an alert system that notifies the medical staff of an abnormality concerning the patient's health or a device's malfunction, such as a necessary battery change. However, this feature can be abused by an attacker to create false alarms; therefore, the wrong treatment can be prescribed, the patient can make unnecessary hospital visits, or genuine alerts can be ignored, and the patient can even disable this notification functionality which has the effect of missing important notifications .

Extortion/Blackmail

This type of attack consists of blocking access to medical data by an attacker and then asking for a ransom to unlock these data. It can also involve stealing influential people's personal medical history, such as a politician or a star, and then threatening to disclose it publicly if the person concerned does not pay the amount of money requested (59).

Type of Attack

Attack strategies are continually changing. However, they can be divided into passive and active attacks.

Passive Attack

In a passive attack, the adversaries will only listen to the traffic and thus will have the possibility to read messages exchanged between the wearable device and the remote system. By simply accessing the content of the messages, a passive attacker will directly affect the confidentiality of communication. They will have access to sensitive information such as the model, the serial number of the medical device, and capture telemetry data. They can also capture the patient's private data such as health record, name, age, and conditions. In all these cases, the result is a severe violation of the patient's privacy .

Active Attack

The attacker will intercept network messages and give instructions to the wearable device, alter messages transmitted before they reach the remote system, or prevent them from reaching their intended destination. A successful intruder has a wide range of objectives. They might, for example, indiscriminately request information from the medical device to deplete its energy. They may even try to change the device's settings, bypass treatments, or even put the patient in a state of shock (34).

Attack Environment

Threats to the system can be classified according to the adversary's position, i.e., internal attack and external attack.

Internal Attackers

Internal attackers require that the attacker is close to the vulnerable device or nearby and has some rights to enter the network infrastructure. They may be a legitimate user, like a nurse who accesses a celebrity patient's medical data without justification. The attacker near the medical equipment can then cause physical damage or collect some information and use them to launch remote attacks later .

External Attackers

In this case, the attacker does not need to be close to the medical device and does not have administrative access to the system. Instead, they will try to exploit bugs or vulnerabilities of the system remotely (13, 60).

Attackers Motivations

This section discusses various attackers' motivations for targeting IoMT systems (61).

Physical Injury

The compromise of medical equipment poses a severe threat, as it could be used to cause harm to patients. Malicious organizations may target patients for political or criminal reasons, and in some cases, even by terrorist groups. Such attacks can be powerful tools for criminal practices, such as extortion or coercion. For example, during his tenure, former US Vice President Dick Cheney had the wireless communication functionality of his pacemaker deactivated as a precautionary measure against potential hacking attempts (62).

Financial Profits

Economic and financial profits are important motivators for attackers or rivals of Implementable Medical Device (IMD) vendors to conduct such threats. The ability of an attacker to access medical data may be used to sell it or blackmail the patient.

Privacy Violation

Medical equipment collects vital information about a patient's body based on various criteria. This information may be necessary for the patient's diagnosis, care, and operational or surgical procedures. Medical data divulge information about the patient's behavior. Analysis of the data obtained from a pacemaker, for example, will reveal the patient's physical activity history. Such data can be used to distinguish general and unique patterns in the well-being of individuals/groups if collected in a large enough sample across different device types and marks. This type of information can lead to unauthorized and unethical use of sensitive data.

Tracking

Messages from the Medical equipment are sent wirelessly to the system controller. These exchanges typically provide health data and position information about the patients. Attackers can intercept these communications to track or locate a patient.

INTRUSION DETECTION SYSTEM

This section explains the IDS in IoMT systems according to . An intrusion is an attempt to compromise the availability, integrity, confidentiality, or defeat the security mechanisms of an end device or network. The IoMT represents information system that handles sensitive and private data related to the health data of patients, which constitutes a valuable target for an attacker to perform an intrusion. This intrusion can be performed by a remote attacker using the Internet or by a legitimate internal user who abuses their privileges, such as members of the medical team who are motivated by curiosity to access private data or an error in the handling of medical data, which could have severe repercussions to patients. An IDS is a hardware or software product that automates surveillance and analysis of events that occur in an end device like IMD or network to detect signs of intrusion.

An IDS consists of three parts: information source, analysis, and response. An IDS can use several information sources to perform a pre-configured analysis on them. When an attack is detected, the IDS generates a response that can be passive or active. A passive response implies issuing a notification. An active response does an action such as interrupting communication. The purpose of an IDS is not to find out who conducted the attack. Instead, it is to interrupt it because the attacker's identity may be hidden, making it difficult to Recognize.

An IDS differs from other security mechanisms, such as a firewall or an antivirus, in that IDS monitors network traffic and analyzes events to identify potential threats, while firewalls and antivirus software primarily focus on blocking or detecting known threats. However, each security mechanism has its advantages and disadvantages, and their combination can provide in-depth security capable of protecting information systems from various security threats.

Several types of IDSs are classified based on their monitoring approach, information source, type of analysis performed, and response time. There are network-based IDS for the monitoring approach and host-based IDS. Networkbased IDS monitors network packets by listing network segments. Host-based IDS is designed to monitor events and activities on individual end devices, including the operating system, audit trails, system logs, and other data sources, such as medical records. There is also an application-based IDS, a subdomain of the host-based IDS, which monitors the application transaction log file generated by applications to perform attack detection.

There are two types of analysis methods used by IDS: misuse detection and anomaly detection. Misuse detection identifies attacks by matching the analyzed event to predefined patterns, which ensures high accuracy. However, this method cannot detect new or zero-day attacks, and new attack signatures must be added to the predefined templates continuously. On the other hand, anomaly detection identifies suspicious behavior by learning the normal operating pattern of the system using historical data. Any deviation from this normal behavior is flagged as potentially malicious. This method has the advantage of detecting new vulnerabilities and zero-day attacks. However, it can generate many false positives and requires a large training set to build the normal profile.

The response time of IDS can be real time or interval-based.

There are several possible architectures for IDS: centralized, fully distributed, and partially distributed. In a centralized architecture, monitoring, detection, and reporting are performed in a central node. In a fully distributed architecture, the response to an intrusion is carried out in the part of the network where monitoring is conducted. In a partially distributed architecture, the reporting is executed hierarchically.

MACHINE LEARNING OVERVIEW

ML is a subfield of AI that gives a machine the ability to learn from data without explicitly programming it . ML has proven efficient for problems requiring a long list of rules and complex problems where traditional approaches are inefficient. Also, ML shows a great capacity for adaptation to new data, especially in a changing and evolving environment such as the IoT system. ML has also shown a great ability to obtain insights from large volumes of data .

These ML capacities can be used to enforce security in the IoMT or at least improve it. Some studies demonstrate that using ML in IDS effectively detects zero-day attacks and new vulnerabilities, while IDS that rely on rules and signatures can only detect known attacks.

ML can also be used to learn the behavior of a person or an object by using the data generated to create a socalled normal profile, so any behavior that deviates from the normal profile is considered abnormal and consequently is detected, this is what is done in the field of anomaly detection.

Three types of ML can be used to solve security problems in the IoMT: supervised learning, unsupervised learning, and semi-supervised learning.

For supervised learning, the training data are labeled. The relationship between inputs and their appropriate output is captured. For this, there is a need to train a model with labeled inputs, which are used to predict or classify new data . There are two types of supervised algorithms, which are regression and classification. The regression predicts the next continuous value based on the previous ones. On the other hand, classification predicts discrete variables and separates the data into different categories. Examples of the techniques that can be used for regression and classification are Support Vector Machine (SVM), Decision Tree (DT), Random Forest (RF), Naive Bayes (NB), and artificial neural network (ANN).

Unsupervised learning involves training ML models on unlabeled data, as manually labeling data can be challenging and time-consuming. Instead, unsupervised learning algorithms analyze the data and identify patterns, relationships, or groupings among the data points. Some popular unsupervised learning techniques for clustering data include Kmeans, k-Nearest Neighbor (KNN), and Self-Organizing Map (SOM). Unsupervised learning can effectively divide large datasets into meaningful clusters to aid further analysis or decision-making .

While obtaining unlabeled data is often straightforward, leveraging its potential can be a significant challenge. Semi-supervised learning presents a solution by incorporating labeled and unlabeled data to build ML models that can classify data with improved accuracy. Compared to traditional supervised learning, semi-supervised learning reduces the need for manual labeling while producing models with greater accuracy. As a result, this approach has a special place in theoretical research and practical applications .

DL is a subdomain of ML, and it is inspired by the functioning of the human brain to process the signal. DL enables computational models with several layers of processing to learn data representation with several levels of abstraction . DL differs from classical ML in its ability to capture the relevant feature previously done manually and required human intervention. Another advantage of DL compared to traditional ML is its performance on a large dataset. Therefore, this method is perfectly adapted to IoT systems and their applications, such as IoMT, which generates a huge volume of medical data. There are three types of DL: supervised example Convolutional Neural Network (CNN), unsupervised example the Deep Autoencoder, and finally, the combination of these two types, which is the hybrid DL, example ensemble of learning networks.

REVIEW OF MACHINE LEARNING APPLICATIONS FOR IoMT SECURITY

Health data are sensitive and can attract the attention of attackers for various reasons mentioned in section 5.6. It is essential to protect medical data from threats by adopting a solution that ensures the security of this data during collection, transfer, storage, and processing. Protecting patients' privacy from unauthorized access is also necessary to avoid disclosing sensitive information to malicious entities. In addition, security solutions must consider the computational, storage, and energy limitations of medical devices and the heterogeneity, dynamics, and quantity of medical data generated within the IoMT system. In light of these constraints, ML has the potential to provide a solution for intrusion detection.

This section reviews the papers that have proposed a security solution based on ML for the different IoMT layers, specifying their objectives, the method employed, the dataset used, and the results obtained. Tables , , and 7 summarize the papers explored in this review, mentioning the methods, applications, advantages, disadvantages, and dataset.

ML for Data Collection Level Security

Sensors associated with patients allow constant monitoring of their health status and automatic medication for people suffering from chronic diseases. This technology, despite its advantages, must be protected against security threats due to the wireless transmission of medical data to a personal server and the possibility of configuring the medical equipment via a programmer device, which increases the surface of the attack. These security threats can be either intentionally caused by hackers or unintentionally caused by the environment due to interference. Patients need a security solution that detects such threats, differentiates them from emergency cases and avoids lethal doses of medication.

Among the different medical devices that researchers have investigated to provide a security solution, there are cardiac implants that provide electrical impulses to stimulate the cardiac muscles in case of abnormalities in the heart rhythm. A well-placed attacker can cause an electrical impulse that can be fatal for the patient. To avoid this kind of situation, the researchers (Kintzlinger et al., 2020) in proposed a system that detects and prevents cyberattacks against ICD. It is implemented at the level of the programmer's device. The Cardiwell is a decision aid for doctors that, in case of detection of an anomaly, generates an alert with the necessary details that allow the doctors to decide then if they pass the programmer commands. The Cardiwell is a multi-layer Security scheme, and it consists of six layers of security. The first five layers use rules and statistics, while the sixth layer uses the method of one class SVM, which is based on ML. To validate their solution, tests were performed on a dataset collected from volunteer patients from different hospitals and clinics over four years. This dataset consists only of benign programmer commands sent from a programmer device to an ICD and which represent a total of 775 samples, while experts generate malicious programmer commands and represent a total of 28 samples. After performing the different tests, the best results obtained are True Positive Rate (TPR) = 0.914, False Positive Rate (FPR) = 0.101, and Area Under the Curve (AUC) = 0.947. However, layers three to six are inefficient and do not participate in improving the results, which according to the authors, is due to the poor datasets that need to be enriched.

The study by , as described in , presents a novel approach for detecting abnormalities in Electrocardiogram (ECG) data. The authors proposed a centralized solution and chose a simplified Markov model-based detection mechanism due to the changing nature of ECG data over time. The proposed approach involves extracting attributes from the ECG data, followed by reducing the dimensionality of the dataset using the discrete wavelet transform. The reduced dataset is then partitioned into sequences, and the probability of each sequence is calculated to determine if any changes have occurred. If an abnormality is detected, the system associates an abnormal tag with the corresponding data and forwards it to the hospital server for further evaluation by nursing staff. The evaluation process is designed to determine the normality of the received data. To test the efficacy of their approach, the authors utilized a dataset from MIT-PHYSIOBANK and introduced 5% and 10% of attacks composed of forgery, unauthorized insertion, and ECG data modification. After conducting the experiments, the authors achieved a high detection rate, reduced training time, and a high TPR.

Other researchers have studied the security of the insulin pump system, which allows the automatic administration of insulin according to the amount of glucose in the patient's blood. However, an intruder can cause a lethal insulin administration if the device is compromised. In this perspective, the researchers in addressed the security gap between the Carelink and the insulin pump, two components of the insulin pump system where the attacker can carry out two types of attacks; the first one is the bolus dose where the attacker delivers a large amount of insulin in a short period. The second possible attack is the basal dose, where the attacker delivers an insignificant amount of insulin over a long period, which can threaten the patient's life. To address these issues, the authors propose to use a supervised ML algorithm using SVM with a regression method to learn the normal insulin dosage of each patient at different parts of the day. The authors collected insulin pump log files from four patients over six months to generate the dataset. Each log entry is composed of infusion rate, dosage, blood glucose level, patient ID, and time of day for each infusion. After performing different tests, the authors obtained better results with the non-linear SVM than the linear SVM by getting a score of 98% of success rate in detecting a single overdose attack and a high success rate in chronic overdose attack detection. The authors propose deploying the model with an update every 90 days.

In the case of anomaly detection, an alert message is raised. The authors have also defined a value of insulin that, if exceeded it, indicates that the patient is in an emergency and, therefore, the system is deactivated.

In another study made by in , The authors proposed to secure the insulin pump against attacks that aim to alter the functioning of its system to deliver a lethal dosage of insulin to the patient. To address this issue, the authors propose using Long Short-Term Memory (LSTM), a DL algorithm, to define a threshold value for the insulin dosage delivered to the patient. If the insulin dosage value exceeds the threshold value, the system calls the patient to perform a gesture by raising the thumb or spanking it down, which is captured by a gesture sensor. The authors propose to use a gesture sensor because they assume that the patient can feel and judge the significant change of insulin in their body through symptoms like nervousness, trembling, and weakness. Therefore, depending on these symptoms and the dose of insulin to be administered, the patient can accept the insulin dose by raising the thumb or refusing it by lowering it. To test their solution, the authors used a dataset containing log files generated by the insulin pumps system over the last three months to train and test the LSTM and determine a threshold value.

In a study conducted by ) in ( ), the authors proposed a solution for detecting fake glucose measurements in the entire insulin pump framework, which comprises a continuous glucose monitoring system, a sensor, a transmitter, an insulin pump, a remote control, and a one-touch meter. The authors proposed a solution that uses the Multi-Layer Perceptron (MLP), a DL algorithm, to classify glucose measurements in the blood as genuine or fake. To evaluate the effectiveness of their solution, the authors used the Pima Indians Diabetes dataset (72) and achieved 93.98% of accuracy. Furthermore, the authors employed the NB algorithm to test the reliability of their system and obtained a success rate of 90%. According to the authors, this high success rate is due to the deployment of their model on a chip using Field Programmable Gate Arrays (FPGA), which can be integrated into any equipment used in the insulin pump framework, thereby securing it against erroneous blood glucose measurements.

So far, the methods used to secure the insulin pump system are based on supervised learning methods. However, the study conducted by in proposed using an IDS based on unsupervised ML to secure the insulin pump injection against four generated attacks: Long Resume, Single Acute Overdose, Underdose, and Chronic Overdose. For this purpose, the authors proposed using a deep autoencoder and a DL algorithm to classify the logs generated within the medical equipment. To test and evaluate their solution, they applied their method to the Diabetes Data Set . They measured the model's performance in terms of accuracy, precision, F1-measure, and recall. The results obtained exceed other traditional ML methods and previous work.

In a pioneer work carried out by (Rathore et al., 2019) in ( ), a solution based on ML was proposed to enhance the security of DBI. A DBI comprises a quadripolar electrode implanted in the human brain, an Implementable Pulse Generation (IPG), and a controller that switches on/off the medical device. Some IPGs are customizable to modify voltage levels. The primary function of the DBI is to regulate the Rest Tremor Velocity (RTV) by maintaining its value at zero through electrical charges. Movement disorders and chronic diseases like Parkinson's arise when the RTV deviates from zero. An attacker with access to the DBI can attempt to modify the RTV's value, thereby seriously endangering the patient's life. To address this issue, the authors modified the RTV value to simulate various attacks. They proposed to use LSTM, a DL algorithm, to predict the RTV value at time T. By detecting and classifying any deviations from the predicted RTV value, the proposed solution can prevent potential attacks on the DBI. To create and test the model, the authors used a dataset obtained from Physionet , which contained 173,398 samples with ten features. However, the authors focused primarily on the RTV attribute, considered the most critical attribute since its modification by an adversary could have detrimental effects on the patient. After conducting various tests, the model efficiently classified attack strategies with minimal loss values and training times.

The solutions explored so far have focused on securing a single medical device. This section reviews more general solutions that include multiple medical devices. In this regard, in suggested adding a security layer for IMD by using patient IMD access pattern and SVM. This solution prevents authentication requests from illegitimate programmers or readers, saves energy, and counters attacks that drain IMD energy resources. If the IMD's battery power is depleted, surgery is required to replace the battery, which can be life-threatening. The additional security layer implements a ML-based cell phone model using SVM that classifies authentication requests from readers. Depending on the response of the cell phone, three situations are considered: 1) in case the request is classified as benign, then the IMD can perform the authentication with readers, 2) in case the request is classified as malicious, then the IMD put itself on standby to not waste more energy. 3) If the model fails to classify the request, the decision is left to the patient, who can authorize or deny the authentication request. For the emergency, the authors suggest assigning a value to cardiac implants that signify a critical condition for the patient when reached. In this case, they suggest either disabling the classification or using a backdoor accessible via a key shared between the IMD and the authorized persons to guarantee access to the implant. The dataset used to create the model consists of 3000 entries, of which 2500 are used to train the model and 500 to test it. The dataset is composed of five attributes which are the reader action type which determines the type of action that the reader wants to perform on the IMD, a time interval of some reader's action, location (home, hospital, pharmacy), time, and day (weekend, weekday). After performing the different tests, they obtained an average accuracy of 90% for the linear SVM and 97% for the non-linear SVM.

Other researchers in ( ) presented a secure framework to detect malicious activities in the Smart Healthcare System (SHS). The proposed framework uses different ML: ANN, DT, RF, and KNN, to detect malicious activity in the SHS. The data used to evaluate their framework are collected from eight different databases. The dataset obtained contains 20,000 samples, of which 17,000 represent data from healthy people and people suffering from diseases, and 3,000 represent attacks that simulate three different threats, which are compromised medical devices, DoS, and false data injection. After performing the tests, they obtained 91% accuracy and 90% f1-score.

In another work carried out by in , they proposed a centralized Markov chain-based solution for the detection of anomalies from the data collected by biosensors in WBAN that is composed of sensors and a Local Processing Unit (LPU). In the proposed system, only the measurements captured at the sensors that deviate from the expected values are communicated to the LPU, reducing energy consumption caused by the transmission of routing data. The proposed method is based on a Markov Model (MM) constructed based on the Root Mean Square Error (RMSE) between the forecasted and measured value for complete attributes. The method intends to work with LPU to detect abnormal deviations in the gathered data and reject erroneous or added measurements. After detecting physiology-related changes and removing erroneous or inserted measures, the system alerts the healthcare staff. To test and evaluate their system, the authors used a public dataset containing real data obtained from Physionet . After performing the different tests, the authors obtained 100% TPR while maintaining a low False Alarm Rate (FAR) of 5.2%. They also compared their approach with other existing methods that use the Markov chain for ECG anomaly detection and other supervised ML algorithms: SVM, KNN, J48, and the distance-based method. The system proposed in this paper exceeds the MM-based ECG abnormality detection system by a small margin and outperforms the ML methods regarding accuracy.

After reviewing the different solutions of security based on ML for data collection level, most of these researches are focused on the security of cardiac implants and insulin pump injection systems . There is just one study based on the security of DBI . However, other medical implants use wireless communication and are not yet investigated, such as the Gastricelectrical stimulator. This medical device stimulates the smooth muscles of the lower stomach equipment to help control chronic nausea and vomiting associated with Gastroparesis. This equipment uses wireless communication that suffers from a lack of encryption, authentication, validation mechanism, and Hardware/Software error , making it vulnerable to different attack types, including eavesdropping, information disclosure, tampering, jamming, and resource depletion . Therefore, it must be considered when the researchers conceive an IDS for multiple medical devices. -The solution is implemented on an external device (cell-phone) that can be stolen, lost or simply forgotten by the patient -Need software modification of the medical device -At each authentication request, the IMD forwards this request to the cellphone, which causes the IMD to consume energy and must be taken into consideration -This scheme is not designed to support emergencies -The protocol used between the cell-phone and the IMD is not secure -Their solution is not holistic since it is tested against only one type of vulnerable device -The patient must make a decision if the classification is not accurate

-Not mentioned -Not available (Newaz et al., 2019) (77) ANN, DT, RF and KNN Detection of malicious activity in the smart healthcare system -High accuracy and f1score -Computation and detection time considered -Overhead is not calculated -The FPR metric is not mentioned -They did not specify where this solution is deployed -Use different datasets Continue on the next page

ML for Transmission Level Security

The transmission of medical data between devices composing the IoMT and the server enables the remote healthcare system to continuously monitor and treat patients in real time. However, the sensitive nature of the data exchanged represents a high interest for cyber-attackers, who, in case of a successful attack, can cause severe repercussions for the patient, ranging from violation of privacy to death. In addition, the heterogeneous nature of the devices used increases the surface of attack, which requires the design of a secure architecture for the IoMT.

One such proposal was made by (Gao and Thamilarasu 2017) in their paper . Their proposed solution involves using ML methods to detect attacks targeting connected medical devices by learning the normal behavior of the device and identifying any deviations from it. The ML model is deployed on an external device that monitors the network and alerts the patient if an anomaly is detected. To test the effectiveness of their solution, the authors used three datasets of different sizes generated by a Castilia simulator and evaluated the performance of DT compared to SVM and k-means. After conducting various tests, the authors found that DTs provided higher accuracy, generated fewer false positives, and had a faster training and prediction time.

In another work performed by (Al-Shaher and al., 2017) in , they proposed to protect the private healthcare system from known viruses, worms, spyware, and denial-of-service attacks by designing and implementing an Intelligent Healthcare Security System (IHSS). The IHSS integrates the firewall, network intrusion detection subsystem, and web filter. The IHSS is intended to enhance the capabilities of these network protection systems using artificial intelligence approaches. The authors use MLP activated by wavelet transform to classify network traffic. The intrusion detection subsystem uses a wavelet neural network to determine which type of attacks are occurring by solving the multi-class problem. In web filters, they use Wavelet Neural Network to detect malware. After evaluating their method, they obtained 93% accuracy with two hidden layers and 90% with one hidden layer.

Other research group proposed an IDS based on a stacked Autoencoder for anomaly detection in the Connected Healthcare System, as outlined in their publication . The method involves several stages of data processing, including mapping, discretization, and normalization, before feeding the data to the stacked Autoencoder. The Autoencoder is used to extract the relevant features, which the ML models then use to perform detection and classify the data as either an attack or not. To evaluate the performance of their IDS solution, the authors collected a real dataset from patients and simulated various types of attacks, such as DoS, counterfeit attacks, temper attacks, and replay attacks. They compared the performance of different ML models, including SVM, NB, KNN, and XGBoost, using metrics such as accuracy, FPR, and FNR. After conducting several tests, the authors found that the XGBoost model achieved the best performance with 97.83% accuracy, 2.35% FPR, and 1.65% FNR.

Other researchers in presented HEKA an IDS based on ML for personal medical devices (PMD). The traffic generated between the PMD and the smartphone is analyzed with a sniffer to detect possible attacks using ML. The n-gram extracts feature sent to the IDS composed of four ML (KNN, DT, RF, and SVM). The HEKA is tested against four types of attacks, including a Man-In-The-Middle (MITM), false data injection, Replay, and DoS individually, then combining MITM and false data injection, and finally, MITM and Replay. They use eight devices composed of four PMDs (iHealth Air Wireless Pulse Oximeter, blood pressure monitor, QuardioArm blood pressure monitor, and wireless weight scale). The final dataset is composed of 731 benign instances and 308 malicious instances. After the realization of the different tests, they obtained a score of 98.4% accuracy and 98% F1-score.

In a recent study conducted by (RM et al., 2020) , a new approach was proposed to develop an IDS based on DL to predict and classify cyber attacks in the IoMT using a unique IP address. The proposed methodology aims to reduce the number of features and instances required for the classification process. This was achieved by transforming the categorical data into numerical data using one-shot coding, then normalizing it to a value between 1 and 0. Then, the normalized data is reduced using principal component analysis (PCA) at the first level and gray wolf optimization (GWO) at the second level, extracting only the most important features. The reduced dataset is then ranked using a DL algorithm using deep neural networks (DNN). To evaluate the effectiveness of their proposed solution, the authors used a dataset obtained from Kaggle containing data collected by a wireless sensor network. They compared the performance of their methodology with other commonly used ML algorithms, including KNN, NB, RF, and SVM, using the measures of accuracy, specificity, and sensitivity. After performing various tests, the study found that the proposed methodology improves IDS accuracy by 15% and reduces learning time by 32%. These improvements would enable timely alerts to be generated in the event of healthcare system intrusion detection.

In another work carried out by in , they proposed an IDS using ML and multi-class classification for the healthcare IoT within the smart city. The authors used CNN as an ML method to classify the network events generated by different medical devices into four classes, namely (critical, informal, major, and minor). Before the data are fed to the model, the data are preprocessed by transforming the categorical data into numerical data, then normalizing the data to take values within the same range. To evaluate their model, the authors generated a dataset by collecting data from six medical devices and then used them to compare their model results with other ML models regarding AUC, F1-score, Precision, and Recall. After performing the different tests, the authors found that their CNN model produces better results than other ML methods.

In another work performed by , they presented a novel approach for predicting Distributed Denial of Service (DDoS) attacks in healthcare systems, as opposed to merely detecting them . The authors demonstrated that DDoS attacks cause traffic data to become chaotic, which can be analyzed using the Lyapunov Expansions Analysis and the Echo State Network. To implement their approach, the authors first represented network traffic as time-series data and applied a simple exponential smoothing method to predict future traffic. They then calculated the time-series prediction error by subtracting the predicted data from the actual data, which served as the basis for DDoS attack analysis. The authors then utilized a recurrent neural echo state network to predict the time series and used the LEA-MA method to detect the DDoS attack. To evaluate their method's effectiveness, the authors tested it on the DARPA 98 dataset and used metrics such as precision, recall, and F1-score. Their experiments showed that their proposed method could efficiently predict DDoS attacks.

In the following, a distributed IDS within the IoMT systems are presented as a solution. Among these solutions, there is work made by (Thamilarasu and Odesile 2017) in . They proposed an approach that utilizes mobile agents to conduct penetration testing and secure the medical equipment network. The proposed system is characterized by its hierarchical, autonomous, and distributed nature. Intrusion detection is performed using a regression algorithm at the medical equipment level and ML techniques at the network level. Mobile agents traverse from one node to another or within a cluster, collecting network activities or device data based on their role as network or device intrusion detection agents. At the end of an intrusion test, the mobile agent classifies the collected samples as voluntary, malicious, or suspicious. The mobile agent migrates to another node if the samples are classified as voluntary. However, if the samples are malicious, an alarm is generated, and the data is sent to the cluster head. If the samples are suspicious, a request for intervention is sent to the cluster head. The cluster head deploys a special agent to collect data from the network or medical equipment of the entire cluster. The collected data are then tested to determine whether they are benign or malicious. Additionally, the system incorporates a security mechanism to detect intrusion at the cluster head level, which is achieved by using the cluster head agent that performs anomaly detection while traversing the cluster head network. The authors evaluated their proposed solution using OMNeT Castalia 3.2 simulator (82) and tested five ML algorithms (SVM, DT, NB, KNN, and RF) to detect anomalies at the network level. Based on the accuracy, Cost Ratio, Feedback Reliability, training time, Total Rank Score, and Energy Overhead, DT produced the best results. Moreover, to detect anomalies in devices, the authors employed a cubic model of polynomial regression that balanced accuracy, overfitting, and computational resources. Finally, the proposed system was tested in a simulated hospital network topology and showed high accuracy, low overhead, and scalability.

Furthermore, in another study reported by , a framework for securing remote healthcare systems was proposed . Given the distributed nature of such systems, the authors employed multiple agents, each categorized based on their energy consumption and sensitivity to security risks. The resulting framework consists of three agent classes: sensors, smartphones, and databases. The first class, comprising sensors, utilizes a non-linear SVM-based anomaly detection approach, which consumes less energy and is effective for the limited data available from sensors. The second class, including smartphones with higher energy autonomy, uses a misuse-based intrusion detection system. The third and most critical class, which involves databases storing sensitive patient information, uses a hybrid detection system based on anomaly and misuse detection methods, as it is more prone to attacks and therefore has the highest security requirements. The authors evaluated the framework using the NSL-KDD dataset to detect various attacks, including DoS and user-to-root. The results demonstrated the effectiveness of the proposed framework, with efficient execution time, low energy consumption, high accuracy, and a low number of false positives.

In more recent studies, researchers explore other architectures that can be used in the context of IDS in IoMT systems: fog-cloud, SDN, and federated learning. In this regard, the work carried out by in ( ) developed a framework for detecting attacks in fog nodes . The authors used Online Sequential Extreme Learning Machine (OS-ELM) due to its fast learning speed. However, since OS-ELM produced inconsistent results, the authors employed a set of OS-ELM and employed majority voting to determine the presence of an anomaly. Prior to applying the ensemble of Online Sequential Extreme Learning Machine (EOS-ELM), the authors preprocess the data by converting discrete values into numerical values. Subsequently, they utilized the Information Gain algorithm and voting method to select features, then normalized the chosen attributes to values between 0 and 1. To evaluate and test their framework, the authors utilized NSL-KDD . After numerous tests, the authors found that EOS-ELM outperforms extreme learning machine, OS-ELM, and ML regarding accuracy, detection rate, and FPR.

A recent study made by in proposed an IDS that utilizes ensemble learning and a fog-cloud architecture to detect cyber-attacks in IoMT networks. The system preprocesses traffic data by converting categorical values into numerical values, replacing missing values with the mean of the corresponding feature values, and selecting the relevant features for intrusion detection using the correlation coefficient method. The numerical values are then normalized using the min-max technique to ensure they fall within a specific range. The system uses a learning set consisting of NB, DT, and RF algorithms, which produce three prediction outputs. These outputs are then fed to XGBoost to produce the final output using majority voting. When an intrusion is detected, the administrator is alerted. The framework is deployed using a fog-cloud architecture, which utilizes Software as a Service at the fog level and Infrastructure as a Service at the cloud level. The authors evaluated their framework using the Ton-IoT dataset , representing data collected from heterogeneous and large-scale IoT networks. The evaluation metrics were accuracy, detection rate, precision, FAR, and F1-score. The results show a detection rate of 99.98%, an accuracy of 96.35%, and a reduction of up to 5.59% of the FAR. These results surpassed those of previous studies that used In another research made by in , they proposed to use of deep hierarchical stacked neural networks to detect attacks that would attempt to modify the data flow, including meta-information that transits between the gateways and the edge cloud and between the edge cloud and the core cloud within multi-cloud healthcare systems called MUSE. This method includes reusing the edge cloud's trained layers to merge them and form a pre-trained model at the core cloud level. The tests were performed on three different datasets: UNSW-BOT-IoT and UNSW15 and one generated by the authors. A comparison was made with the method that does not reuse the trained layers of the edge cloud. The results show that the solution proposed by the authors improves the training efficiency and accuracy with a rate that varies between 95-100% and reduces the training time by 26.2%. The proposed IDS solution at the fog level has the advantage of being close to the IoT devices and therefore offers a rapid response, decentralization and preserves data privacy. However, the fog level faces an increase in the amount of data arriving at the fog level, which requires a lightweight solution. For this purpose, in proposed to use an incremental ensemble learning method called Weighted Hoeffding Tree Ensemble system consisting of an incremental learning classifier for the industrial IoMT. Tests on NSL-KDD and ToN-IoT (94) datasets and comparison with single incremental classifiers and Bagging Hoeffding Tree ensemble algorithms show that the proposed solution is lightweight and presents a trad-off between accuracy and overhead (CPU, memory and time) and outperforms the results of previous studies.

Other works have proposed SDN as an architecture for ML-based IDS within IoMT systems. Among them is the work led by (Khan and Akhunzada, 2021) in , which proposed a hybrid model based on DL for malware detection in IoMT deployed at the SDN plane application level. The system proposed by the authors consists of feature extraction using CNN, and then LSTM is used to classify the data as malware. The authors used the current state-of-the-art IoT malware publicly available dataset to evaluate their model. In addition, they compared their model with the constructed hybrid DL-driven. After performing various tests, the authors found that the proposed model outperformed the other methods regarding detection accuracy and speed efficiency.

In another study, in proposed to use IDS based on ML to secure the IoMT architecture based on SDN against cyber threats. For this purpose, the authors propose using a hybrid model combining the LSTM and GRU deployed at the SDN control plane. The tests were performed on the CICDDoS2019 dataset , which was subjected to a preprocessing consisting of eliminating the missing value, transforming the non-numeric values into numeric values, applying the one-hot encoding to output label, and then using MinMaxScaler for data normalization. They compared the results with other classifiers: cu-GRU, DNN, and cu-BLSTM, as well as other previous studies.

The findings indicate that their solution outperforms other models and prior studies in terms of accuracy, precision, F1-score, and execution time.

The various IDS solutions proposed to improve the security of the IoMT network do not include measures to protect patient privacy. In this perspective, the research realized by in proposed to use an IDS based on ML and federated learning to secure medical cyber-physical systems composed of sensors, mobile devices, and servers. The distributed and scalable nature of this system makes it more effective in protecting patient data privacy. The proposed IDS system follows a process where mobile devices first register with the server and are assigned to a cluster based on their health history. This cluster is associated with a federated model stored on the server. Each mobile device downloads the federated model, trains it, and updates it using patient data. The server then selects some or all of the mobile devices that compose the cluster and asks them to send their updated model. The server then calculates the average weights and biases of the received models to update its federated model, which mobile devices can download. This process continues until the model converges. Mobile devices can be in two modes: testing and learning. In learning mode, the mobile device can predict and send its updated model to the server. In the testing mode, the mobile device can only predict the new data and does not send the model to the server, saving communication costs. The proposed system allows the detection of anomalies, such as a value of an attribute that exceeds its usual value range or has an unexpected correlation with other attributes. In these cases, an alert is generated on mobile devices, allowing the nursing staff to react. The system was tested using the MIMIC dataset from Physionet , with the addition of simulated attacks such as DoS, data modification, and injection. The performance metrics used to evaluate the system were detection accuracy, FPR, recall, F1-score, training time, and communication overhead. The tests produced high detection rates and low false positives, with training times equivalent to or better than using a single ML. Additionally, increasing the number of patients does not affect the training time, which improved the accuracy and decreased the FPR by obtaining more data.

In another study made by in , the author proposed a solution for intrusion detection at the IoMT networks level using Hierarchical Federated Learning (HFL) based on hierarchical long-term memory. Their solution is deployed on the distributed dew servers of the IoMT framework, with a backend supported by cloud computing at the edge layer. The proposed HFL solution aggregates models from different entities that compose the healthcare institution at the dew-servers level to obtain local models. These local models are then aggregated at the cloud computing level to obtain the global model, which is redistributed to the different dew servers participating in the learning process. This iterative process is repeated until the global model achieves a high accuracy. The authors evaluated their solution on TON-IoT and NSL-KDD (92) datasets. They preprocess the datasets by removing unnecessary features, converting non-numeric values to numeric, and applying one-hot encoding to categorical values before normalizing the data to ensure they are represented in the same range. Finally, they applied PCA for dimensionality reduction. The results showed high accuracy, precision, recall, and f-score compared to Recurrent Neural Network (RNN), Gated Recurrent Unit (GRU), LSTM, and the previous study, with minimized computation costs.

The previous ML models lack interpretability and do not explain how they detect attacks, making them black-box models. However, presented a solution to this issue in their study . They utilized Simple Recurrent Units with skip connections to avoid the vanishing gradient problem for detecting network attacks in the IoMT, which was deployed at the gateway and router levels. To increase trust in their model, the authors employed Explainable AI (XAI) design using the Local Interpretable Model-Agnostic Explanations model to interpret and explain how the model classifies the data. The evaluation was performed on the ToN-IoT (94) dataset, which underwent preprocessing such as labeling categorical data, normalizing data to the same scale, and applying PCA for dimensionality reduction. The results indicate that the proposed solution by the authors is more efficient than two RNN variants: LSTM and GRU, in terms of Accuracy, Precision, Recall, and F-measure. Additionally, the proposed solution has a reduced computation cost compared to previous studies. Furthermore, XAI revealed that the basic category of IoT device features significantly impacts data classification.

The datasets used to evaluate the ML models in the above solutions consist of either network or medical data. The research performed by in , proposed an IDS for healthcare that uses medical and network data. For this purpose, the authors developed an architecture that allows the creation of a dataset containing medical and network data and simulated MITM attacks to perform two types of attacks: spoofing and data alteration. The generated dataset ( ) is used to test and evaluate different ML methods: SVM, KNN, RF, and ANN, with the following metrics accuracy, AUC, and time of execution for training and testing. After performing the different tests, the authors found that their system, which combines medical and network data increased the effectiveness of ML methods by 7 to 25% for the detection of threats in health monitoring systems in real time.

A literature review reveals that current proposals for using IDS based on ML in the IoMT environment have mainly explored centralized architecture solutions . However, some researchers have also investigated distributed solutions . Incorporating IDS and blockchain technology to achieve a decentralized architecture in the IoMT setting presents a promising direction for future research. Since it can bring numerous benefits to the IoMT environment, for example, it can enhance security by removing the risk of a single point of failure, making it difficult for malicious actors to alter data. The immutability of blockchain technology also ensures that data is recorded permanently, providing a trustworthy record of transactions. Decentralization can also improve traceability and reduce dependency on intermediaries, leading to more efficient and transparent processes. However, several challenges are also associated with using blockchain technology in the IoMT environment. Scalability remains a significant concern, as current processing speed and storage capacity limitations may not be suitable for large-scale applications. Additionally, the energy consumption associated with proof-of-work consensus algorithms can negatively impact the environment. Finally, the lack of standardization across different blockchain platforms can limit interoperability between them.

The future solution must prioritize protecting patient privacy, provide interpretable and explainable ML models, and apply appropriate learning and testing processes using a custom-designed dataset in an IoMT environment. Adherence to these requirements will ensure the development of a secure, transparent, and trustworthy IDS solution for the IoMT setting, which is critical in today's increasingly connected healthcare ecosystem.

ML for Storage Level Security

Medical data received from sensors are centralized in a medical server, which the medical staff can access for analysis. These stored data are of two types: the EMR and the EHR. EMR stores a patient's medical and treatment history in a single place and makes it accessible at a single hospital. While EHR focuses on the patient's general health, it can store and transmit the patient's health data, such as patient history, medication, test results, and demographics . It is necessary to secure access to these data to preserve patients' privacy, protect the confidentiality of medical data, and guarantee their availability and integrity to make an accurate diagnosis.

In this perspective, in proposed to use statistics and ML to identify suspicious access in EHR access logs. The authors used Logistic Regression (LR) and SVM to classify new access as suspicious with ranking. The high-scoring event is investigated first by the privacy officers. To create the model based on LR and SVM, the authors used the privacy agent to label the selected events as suspicious or appropriate using an iterative refinement process. Then they trained the model using 10-fold cross-validation. The authors used sensitivity, AUC and compared their model with the rule-based technique to evaluate their model. After performing several tests, the authors obtained more than 0.90 of AUC and more than 0.75 of sensitivity. They find that using a method based on statistics and ML to detect suspicious access in EHR is possible and is more effective than a rule-based technique. For the same purpose, a different approach is proposed by in for detecting privacy violations resulting from inappropriate access to EHR. The authors use an approach inspired by collaborative filtering for inappropriate access detection, where the objective is to predict a label for a pair of entities interactions. Their solution incorporates explicit and latent features for staff and patients, allowing for the generation of a fingerprint customizer for users based on previous access history. To evaluate the model, the authors used two datasets named "hospital" and "amazon" (109) using the following metrics: RMSE, the area under curves, and precision-recall curves, then they compared the results obtained with three ML algorithms: linear regression, LR, and SVM. After performing the different tests, the authors improved the performance considerably over the other approaches and detected inappropriate access.

Furthermore, the work performed by in proposed an unsupervised learning model for insider threat detection in a collaborative environment using access logs called a community-based anomaly detection system. The approach proposed by the authors is hybrid; they use singular value decomposition, a special case of PCA, to infer communities from relational networks of users, and then they use KNN to create a set of nearest neighbors. The created model detects anomalous users by identifying users who have diverged from typical communication behaviors. To evaluate their model, the authors used two datasets: a six-month collection of access logs from an actual EMR and another dataset that reports the editorial board composition for a set of journals over five years. After running the different tests, the results showed that their model could detect the simulated user with high accuracy, outperforming other anomaly detection models.

Another work carried out by in , presented a new approach to secure image data processing in the cloud environment based on ML. Their method consists of segmenting the image into four distinct parts depending on pixel intensity level using Fuzzy C-Means Clustering (FCM) and SVM. The FCM is utilized for extracting color features at the pixel level. These features are fed to the SVM to be classified into different regions, allowing storage of the image in the cloud in a segmented format. The authors have also proposed a 3-layer architecture instead of the traditional 2-layer architecture by introducing a CloudSec module that allows the encryption of data in transit using the HTTPS/Secure Socket Layer. The CloudSec module also allows for restricting access to the data and detecting the misuse of cloud resources by using an access control mechanism.

In a work performed by (Sicuranza and Paragliola, 2020) in , they proposed a hybrid IDS for cyber-attack detection against EHR. The proposed system uses agents deployed within the monitored IT infrastructure. They are responsible for collecting, normalizing, and performing security analysis on the logs collected from the local level. Then these agents generate events that are sent to the IDS for analysis. The IDS comprises a misuse detection module and an anomaly detection module. The misuse detection module is rule-based, effectively detecting the well-known attack signature. The anomaly detection module allows the detection of zero-day attacks. Anomaly detection uses three classifiers: DT, Neural Network, and k-means. The results of these classifiers are sent to the voting system to improve the accuracy of each classifier. In addition, an expert system module is designed to resolve any potential conflict between the presence/absence of attacks as determined by the abuse detection module and the anomaly detection voting system. A dataset was generated by monitoring the Italian EHR system to test the proposed model. Three separate attacks on the EHR systems were used to test the misuse and anomaly detection modules. The results demonstrate the efficiency of the proposed solution. In addition, in a study reported by (McGlade and Scott-Hayward, 2019) in , they proposed a framework for detecting privacy and availability issues in EMR systems. The framework is based on ML and uses the SVM to detect privacy-related incidents and the Exponential Moving Average (EMA) to detect anomalies in message flow that may cause a denial of service. To test the framework, the authors have used synthetic data generated by the Synthea tool (113), a synthetic patient population simulator. They have tested three ML algorithms on the dataset, namely SVM, KNN, and multinomial NB, to detect anomaly-related to the confidentiality of the EMR system and EMA for the detection of anomaly-related to the availability of the EMR system. After performing different tests, the authors found that SVM exhibits the best performance regarding accuracy and recall than the two other methods. They also find that EMA can successfully detect message surges, leading to a denial of services.

EHRs and EMRs are critical systems for storing sensitive patient information. Ensuring this information's confidentiality, integrity, and availability are of utmost importance. The literature review reveals that most studies have concentrated on detecting unauthorized access to EHRs . Only one study has focused on the confidentiality and availability of EMRs . However, there is a need for further research in ML to ensure the integrity of both EHRs and EMRs. Exploration in this area holds great promise and could be a valuable direction for future investigation.

CHALLENGES AND LIMITATIONS

The exploration of the different solutions proposed in the literature using IDS based on ML for IoMT led us to identify the limitations and challenges of this approach at the different layers that compose IoMT as follows:

Data Collection Level Security

The deployment of ML models in medical equipment presents a challenge due to its various limitations. Three methods of deployment have been proposed, which include deployment of the ML model on medical equipment , deployment on a third-party device , or deployment on a chip followed by integration into the medical equipment .

The deployment of ML models on resource-constrained medical devices can have consequences such as shortened battery life, which may require surgery for battery replacement and pose a risk to the patient. Deployment on thirdparty devices involves communication between the devices and medical equipment, which requires a modification at the software level of the medical device. However, medical device manufacturers do not permit such changes, and third-party devices must also be protected from potential attacks. Deployment on a chip and integration into the medical device involves software and hardware modifications. Lightweight ML models that satisfy the limitations of sensors may be a promising area of research in addressing the challenge of deploying ML models on resource-limited medical devices. Additionally, the ML model must be secured to prevent data manipulation during the learning or testing phase that can compromise the results .

Detecting anomalies in medical data can arise from various factors, including poor communication quality due to interference or malfunctioning sensors, medical emergencies that result in severe illness, and security attacks carried out by malicious entities. It is crucial to differentiate between these various sources of anomalies, as prompt identification and treatment are necessary for emergencies.

The limited availability of public datasets generated explicitly for security purposes and containing medical data presents a challenge for researchers. Some have resorted to using existing medical datasets, such as PHYSIONET (100), and modified specific values with the help of healthcare professionals to simulate attacks, leading to questions about the validity of their findings when applied in real-world scenarios. Other studies have used real medical equipment volunteers wear to collect health data. However, these results may need to be more representative as the volunteers may not have any underlying health conditions. Using simulators, such as CASTILIA , to generate medical data and attacks can also result in unforeseen difficulties during practical implementation. The acquisition of a high-quality, diverse, and representative dataset containing medical data collected from individuals with and without illnesses, and generated explicitly for security purposes, remains a significant challenge.

Another limitation is that the various IDSs proposed in the literature focus on a restricted number of medical devices to generate a medical dataset. However, when patients utilize multiple medical devices, it becomes imperative to have integrated solutions to detect intrusions from these different medical devices. The challenge lies in designing an IDS solution that can accommodate all connected medical devices, as each has specific data collection and communication methods. Some solutions rely on the patient's ability to determine the occurrence of an attack. However, this approach needs to consider potential limitations such as age, incapacity, or emergency circumstances where the patient may be unable to make such a decision. Establishing effective protocols for communication and decision-making in the event of anomalous behavior detection poses a challenge.

The study has demonstrated that rule-based solutions for anomaly detection in medical data may achieve better results than ML-based anomaly detection systems because some medical attributes contain a range of values that, if exceeded, can be easily detected by implementing clear and defined rules. On the other hand, ML-based anomaly detection can detect anomalies by analyzing correlations between multiple medical attributes. This highlights the need for a comprehensive evaluation of rule-based and ML-based anomaly detection methods to determine their strengths and limitations in detecting anomalies in medical data. Further research should consider this aspect to improve the accuracy and reliability of anomaly detection in medical data.

The generalizability of a ML model constructed from a specific patient's medical dataset is limited, as what may be considered abnormal medical values for one patient may be considered normal for another patient . Ensuring the accuracy of the ML models when applied to different patient populations with varying medical conditions and characteristics remains a challenge.

Transmission Level Security

In developing a Network-based IDS for the IoMT, the unique characteristics of the IoMT system must be considered, such as its distributed, mobile, dynamic nature and heterogeneous communication constraints.

When designing an ML-based Network-based IDS for IoMT security, it is essential to consider the evaluation metrics for the ML model, especially when the dataset is imbalanced. The use of metrics that give higher importance to the minority classes and accurately reflect the ability of the ML model to detect attacks is imperative, as the IDS is responsible for protecting the essential information system against security threats. However, implementing an ML model with an imbalanced dataset presents challenges such as biased results, overfitting, and difficulties in evaluating performance using traditional metrics. When developing the ML model, it is necessary to handle the imbalanced nature of the dataset carefully.

A real-time detection system in the IoMT using ML is crucial for prompt and adequate decision-making in the event of security threats. However, implementing such a system presents several technical challenges, including the efficient and accurate processing of a large volume of data generated by the IoMT system, ensuring a high level of accuracy in the ML model's detection of attacks, and low latency in processing and prediction. The system must also be scalable and have the hardware capabilities to support the ML model and handle large amounts of data in real-time.

The use of black-box models in applications like healthcare is limited due to regulations, such as the General Data Protection Regulation, which prohibits automated decisions in critical sectors. Despite their widespread use in other applications, black-box models present significant challenges, including a lack of transparency, making it difficult to understand how the model arrived at its predictions and identify potential biases. Explaining the model's decisions is also a significant challenge, especially in applications where justifiable decisions are indispensable. Black-box models can also be vulnerable to adversarial attacks and have limited interpretability, making it challenging to debug and finetune the model to improve its performance. Explainable artificial intelligence (XAI) has become increasingly popular in addressing these challenges. XAI allows for creation of models that can be interpreted, understood, and transparent, and the reasoning behind their decisions can be easily explained. By using XAI, the limitations of black-box models can be overcome, promoting responsible AI development and deployment, improving trust in the model, and increasing accountability.

Implementing a real-time detection system for the IoMT using ML requires using a dataset that accurately represents the IoMT system. The utilization of datasets not designed explicitly for the IoMT system may result in a limited representation of the system and its potential attack scenarios, hindering the ability of the ML model to detect attacks effectively in real-world situations. Obtaining a comprehensive dataset encompassing the diverse range of attacks and communication protocols within the IoMT system remains challenging.

The IoMT system requires effective IDS to ensure the safety and security of medical data. Various architectures have been proposed to support these requirements, including centralized, distributed, fog-cloud and federated solutions. While centralized solutions, such as SDN, offer a centralized control point, they also pose challenges, such as the risk of a single point of failure, increased latency, and privacy concerns. Distributed solutions present a unique approach, but the practical deployment of these solutions in real-world situations still needs to be improved . The use of a fogcloud architecture presents a promising approach. However, the challenge of submerged data flow must be addressed in this architecture. On the other hand, federated solutions must consider the risk of adversarial attacks during the model-sharing process.

Storage Level Security

The concept of IDS in the medical server encounters several challenges and limitations. The data structure and format utilized for training the ML model within the medical server are distinct from other servers, making it challenging to extend the model's applicability to other medical institutions.

A large amount of unlabeled data for supervised learning processes presents a significant obstacle for ML practitioners. The lack of labeled data makes it challenging to train the model effectively. The manual data labeling process, which often requires an interview with the patient to ensure correct labeling, can be both time-consuming and resourceintensive. Notably, this manual labeling process and the need for patient interaction result in intrusion detection at the medical server level is not fully automated. Therefore, unsupervised or semi-supervised ML methods should be further investigated at this level with particular attention to reducing false positives.

The possibility of a malicious actor altering a single feature value within an EHR or EMR for a single patient poses a challenge for ML models trained on a large amount of medical data . These models typically rely on identifying patterns within the data and are designed to detect larger deviations from these patterns, making it difficult for the models to detect a single, subtle change in a feature value. Such an attack could have significant consequences, particularly in a medical context where patient data integrity is vital. Measures must be taken to address this challenge, such as utilizing more sophisticated ML models that can detect single-value changes or augmenting the training data with a diverse range of feature changes to enhance the model's ability to identify such modifications.

The difficulty in obtaining public medical data in the form of EMRs or EHRs results from such data's sensitivity and confidentiality. The privacy and security of patients and medical information are of utmost importance. Therefore, the release of such data is often heavily regulated and subject to strict privacy laws and regulations. This presents a significant challenge for those seeking to use the data for research or analysis purposes, as access to a large and diverse sample of medical data is critical for developing and training ML models.

CONCLUSION

A comprehensive survey on how to use an IDS-based ML to secure the IoMT is conducted. For this purpose, the generic architecture of IoMT, which is divided into three layers (data acquisition layer, personal server layer, and medical server layer) is presented. Then the requirements and possible threats that can affect the security of IoMT are provided. Next, the ML-based solutions for IoMT security are reviewed and categorized into three levels: data collection level, transmission level, and storage level, indicating the advantages, disadvantages, and datasets used. Finally, the challenges and limitations of using ML in these categories are discussed. This survey aims to highlight ML ability to bring security to complex infrastructures such as IoMT and the capacity to comply with the particular constraints of IoMT.

The main limitations of this survey are as follows: (i) The literature survey that is the subject of this study may have unintentionally left out the most current non-scientific developments or academic works that were not yet published at the time of the investigation. (ii) Although every attempt has been made to provide background, this research includes several concepts that may need to be referred to additional sources for a complete comprehension. (iii) It is noteworthy that our recommendations are inherently subjective. We intend to encourage additional research and discussion to address these limitations.

CRediT authorship contribution statement

Declaration of Competing Interest

The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

Introduction The Internet of Things (IoT) represents the fourth industrial revolution, in which devices and systems are connected to enable communication and data exchange. The first three revolutions focused on agriculture, industry, and information technology. Kevin Ashton, a British technology pioneer, coined the term IoT in 1999 and defined it as a network of physical objects embedded with electronics, software, sensors, and network connectivity, allowing these objects to collect and exchange data, often using the internet . The use of sensors enables machine-to-machine communication, which allows for the exchange of data and information without the need for human intervention. This technology can potentially revolutionize various sectors, including healthcare, transportation, and manufacturing. IoT is experiencing considerable development and is estimated to reach more than 24.1 billion devices worldwide in 2030, representing about four devices per person , which can be explained by the many possible applications that offer IoT. Among these applications is the Internet of Medical Things (IoMT). The IoMT uses sensors that are either wearable or implemented in the human body to collect health data. Then these data are sent to a remote server to be analyzed using Artificial Intelligence (AI) assisted by the physicians. Healthcare has experienced many evolutions in digitalizing health data, as explained in (4) and summarized in this paragraph. The evolution of healthcare began in 1990 with the advent of what is now known as healthcare 1.0. This initial phase involved digitizing medical records, where doctors started entering patient notes into computers. These digital records were then managed and stored by specialized systems such as the Picture Archiving and Communication System and Radiology Information System. The introduction of Healthcare 2.0 saw hospitals adopting systems that integrate and manage the digital data stored on doctors' laptops. Then there was healthcare 3.0, which consists of compiling, and grouping all patient data into an Electronic Health Record (EHR), providing individuals with complete access to their health data and history. Healthcare 4.0 is currently underway, enabled by artificial intelligence, data provided by doctors, imaging centers, equipment, and sensors implemented or worn by patients. This evolution allows doctors and medical staff to make more accurate diagnoses and better treatment decisions and allows hospital managers to control costs. The IoMT is a rapidly growing field leveraged in various health-related applications. One of its key advantages is its ability to provide real-time and continuous patient health monitoring. This technology has proven particularly effective in managing chronic conditions, such as diabetes, where insulin pumps can automatically inject insulin to regulate glucose levels. Similarly, pacemakers, which send electric shocks to the heart when an abnormality is detected, have been used to manage heart disease. Deep Brain Implants (DBI), another medical device enabled by the IoMT, provide electrical stimulation to the brain to treat neurological disorders like Parkinson's. Beyond treating specific conditions, the IoMT has been used for fall detection in older adults and performance measurement for athletes. In addition, it could improve access to healthcare in rural areas that lack medical infrastructure. Moreover, the IoMT produces detailed and accurate medical data, increasing treatment efficiency, reducing medical errors, and identifying diseases in their early stages. This can lead to quicker treatment and improved patient outcomes. By transforming healthcare from curative to preventive, the quality of care for patients is significantly improved, and stakeholders like insurance companies and pharmacies benefit as well. Another advantage of IoMT is the remote access to medical data by nurses and patients' families, eliminating the need for regular hospital visits, reducing costs, saving hospital resources, and containing the spread of COVID-19. Additionally, patients can receive care in the comfort of their own home. Overall, the IoMT is a remarkable technological advancement that has the potential to significantly improve healthcare services, benefiting both patients and healthcare providers. While the IoMT has the potential to revolutionize healthcare through real-time patient monitoring, its adoption faces significant barriers due to security and privacy risks. The use of wireless communication to transmit data from sensors to remote servers creates security vulnerabilities that compromise the data's confidentiality, integrity, and availability, with potentially fatal consequences for patients if incorrect treatments are administered. Several studies have demonstrated that even critical medical devices like Implantable Cardioverter-Defibrillators (ICD), DBIs, and insulin pumps can be hacked. Furthermore, because IoMT data is highly sensitive and personal, unauthorized access or disclosure could result in severe patient privacy violations. Such incidents have occurred in recent years, for example, the Singapore health service data breach that affected 1.5 million patients and the ransomware attack on a French hospital's system . Given these risks, it is essential to prioritize the security and privacy of IoMT data in order to ensure that patient safety is not compromised. Securing IoMT presents unique challenges that traditional security methods cannot efficiently address. One such challenge is the low computational and storage capacity of IoMT sensors, which makes it difficult to apply resourceintensive security measures. In addition, designing a secure system for IoMT must consider caregivers' need for quick access during medical emergencies, as prompt response times can mean the difference between life and death. Moreover, the potential for third-party devices to control and upgrade IoMT equipment increases the risk of security breaches, necessitating the implementation of lightweight security solutions. However, since the attack vectors against IoMT systems constantly evolve, these solutions must be regularly revised and updated to ensure their efficacy against zero-day and new attacks. The following advantages motivated our choice to investigate the use of ML for IoMT intrusion detection: I Machine Learning can give intelligence to the IoMT system and be more suitable to their security requirements. Therefore, these methods can be more effective in emergencies than traditional access control methods. II IoMT and IoT systems generate a large amount of data that can be considered as big data due to their velocity, variety, and volume. These data are valuable sources for security because they can be used to learn normal behavior and detect abnormal behavior at an early stage, limiting the attack's damage. III Deep Learning (DL) algorithms can extract the relevant attributes to perform the classification automatically, which eliminates the necessary extraction process required in traditional ML methods and therefore offer an endto-end security model . IV ML methods can detect zero-day attacks and new vulnerabilities, which threat signature-based methods cannot. In light of these different advantages that can offer the use of ML in a security application, this study investigates its application for the IoMT by answering the following questions: A What is the generic architecture of an IoMT system, its security requirements, and the security threats that can affect it? B What are the different ML-based solutions proposed at the different layers of the IoMT? C What are the advantages and disadvantages of these different solutions? D What datasets are used to train and test the ML model at the different layers of IoMT? The paper is divided into several sections to address the topic of IoMT security comprehensively. In Section 3, the different layers of IoMT architecture are described. Section 4 discusses the various requirements that are necessary to ensure IoMT security. Section 5 presents diverse threats that can undermine IoMT security, detailing the possible attacks that can affect each layer of the system, the types of attacks, attack environments, and the adversary's motivation to conduct an attack. The paper also highlights the significance of IDS in Section 6, while Section 7 presents an overview of the ML technique. Section 8 discusses the state-of-the-art approaches proposed in different layers of the system, highlighting the benefits, drawbacks, and datasets used in each solution. Section 9 sheds light on the limitations and challenges in using IDS based on ML for each layer of the IoMT system. Finally, the paper concludes in Section 10. Figure shows the various components explored in this review paper. Table 2 List of abbreviations FPGA Field Programmable Gate Arrays Wi-Fi Wireless Fidelity CPU Central Processing Unit HFL Hierarchical Federated Learning RNN Recurrent Neural Network GRU Gated Recurrent Unit XAI Explainable AI

RELATED WORK Many review articles address different aspects of security in an IoMT system and include ML to ensure security in these systems. To the best of our knowledge, most of them do not focus on using ML as a method to ensure security in IoMT, and they just mentioned it briefly. Table presents the different review papers that have discussed security in the IoMT, mentioning our main contribution compared with them. H.Rathore, et al. explored issues, security risks relating to the privacy and safety of medical equipment, and solutions in , including anomaly detection based on ML. M. reviewed different authentication schemes and classified them according to their type. They give advantages, disadvantages, and the ability to resist different attacks. They also categorized authentication mechanisms based on advanced methodologies, such as game theory and ML. The work of M. covered a variety of malware attacks against IoMT systems, targeting security criteria, namely confidentiality, integrity, authenticity, and availability of data. The current security approach strategy has generally emphasized key management and intrusion detection using different methods such as ML, authentication, and access control. In the work conducted by A.I. , they discussed security and privacy in healthcare by presenting a detailed survey of possible attacks, their impact, and solutions proposed in the literature, including solutions based on ML along with their limitations. B.Narwal and A.K.Mohapatra in (13) presented a systematic survey on security and authentication in Wireless Body Area Networks (WBAN) to cover the main research elements. In particular, an in-depth classification of protection mechanisms in WBAN is provided along with a thorough analysis of security basics, threats to security, the intruder and their attack strategies, and current mitigation that include ML. The survey presented by A. explained the IoMT ecosystem, reviewed the security requirement and vulnerability of IoMT systems, and presented recent security applications to protect this ecosystem, including blockchain, physically unclonable function and AI/ML. Among the review papers conducted on security in IoMT, only a few survey papers have reported using ML as a method for security purposes in the literature. They describe it briefly and not in a holistic manner. However, a work similar to the current study conducted by S.S. discussed security and privacy in IoMT. They presented the different solutions based on ML proposed in the literature to solve the security challenge of IoMT, giving their advantage, disadvantage, approach, tools, and datasets used. However, the authors focused on network and device-level security and did not discuss the security of electronic medical data when it resides at the medical server level. This paper extends the previous work and discusses the various solutions used for anomaly detection based on ML at the medical device level, at transit, and during the resets by identifying the benefits, drawbacks, and datasets used. Reviewing the solutions at the three levels allow for discussing the ML method used to ensure the security and privacy of the IoMT globally. Table 3 Existing Surveys Year paper Discussed topic(s) Main differences 2017 (9) Security of wireless medical devices This survey provides the security and proposed solutions for the three layers composing the IoMT system 2019 Authentication in the wireless body area network This survey presents the architecture, attacks on each layer that compose the IoMT, the environment, and the attackers' motivations. Then, the different ML-based solutions proposed for the layers forming the IoMT system are discussed 2019 Detection and prevention of malware in IoMT This survey mentioned the attacks that can occur in each layer that composes IoMT, the types and environments of attacks, and the attackers' motivations, not only the malware. The IDS-based ML solutions proposed for the three layers that constitute the IoMT system are discussed in this survey and do not only cover the security of the communications 2020 Security and privacy in the healthcare system The IDS-based ML solutions for the three layers of the IoMT system are provided 2021 Authentication in the wireless body area network The different attacks occurring at the three layers composing the IoMT system are listed, and the solutions that use an IDS based on ML and proposed for the three layers of the IoMT system are discussed 2022 Review the use of new technologies to improve IoMT ecosystem security The security requirements and threats for the three layers that compose the IoMT systems are provided. Then, the IDS solutions based on ML for each layer that forms the IoMT systems are reviewed, which allows identifying the limitations and challenges at each layer of the IoMT systems 2021 The role of ML in solving the security and privacy issue in IoMT systems The different attacks that can impact the three layers of the IoMT and the IDS based on ML solutions proposed for layer three of the IoMT system are presented

ARCHITECTURE OF IoMT Many architectures were presented in the literature. Some research proposes architectures composed of three layers . Other research proposes using an architecture with more than three layers . Different technologies are proposed to manage medical data, such as fog/cloud computing , Software-Defined Networking (SDN) , or Blockchain . This survey paper assumes that a three-layered architecture is suitable for logically dividing IoMT architecture. These layers are data acquisition, personal server, and medical server, and they are explained as follows and illustrated in figure .

Data Acquisition Layer Sensor devices serve as a bridge between the human body and the digital world. There are four types of devices : • The implemented devices: these devices are placed inside the human body, e.g., DBI. • The wearable devices: these devices are on the human body e.g., Smartwatch, Pulse Generator (PG), or Electroencephalogram (EEG). • The ambient devices: these devices allow capturing data from the environment around the patient, e.g., room temperature sensors. • The stationary devices: these sensors are located in the hospital, e.g., imaging devices. These devices are equipped with physiological sensors and low-power computing, connectivity, and storage modules, which are used to gather biomedical and context signals . The data collected are used to manage the treatment and diagnosis of patients' health conditions. These medical devices have other constraints at the internal and communication levels. Internally, the medical implants inside the human body can be rejected by the patient's immune system, resulting in inflammation and pain. The battery of these medical devices is limited and must be changed after a number of years. Traditional security methods such as cryptography can quickly shorten the implant's lifespan, which requires surgery to replace the battery and can be dangerous for the patient. Because of medical equipment's limited memory space, it is impossible to keep track of the exchanges made via log files. Regarding communication, medical equipment can only support short-range communication due to energy limitations . Due to scale, computing capacities, and energy constraints, most wearable devices can only preprocess the sensed data. Alternatively, the embedded low-power computing modules compress the sensed data before sending it to personal devices (i.e., smartphones or desktops) through low and ultra-low-power wireless communication like Near Field Communication (NFC) and Bluetooth Low Energy (BLE) .

Personal Server Layer Medical equipment can send physiological data to personal servers like smartphones and laptops or standard devices like gateways . Personal servers process and save patient data remotely until it is sent to centralized medical servers. The medical data received at the personal server are saved and processed; for example, by adding contextual information such as place and time to detect unusual behavior, these data also can be encrypted or compressed. Then the processed data are sent in a medical standard format like Health Level-7 to the remote medical server using long-range wireless like Wireless Fidelity (Wi-Fi), Global System for Mobile Communications (GSM), or wired communication . This layer is intended to support heterogeneous communication and node mobility and permit the resending of medical data when the network link to the medical servers is interrupted .

Medical Server Layer It consists of a high-performance data center that allows for centralized patient control, complex and long-term behavior analysis, and the correlation of patient data. It also includes a cloud server that makes intelligent decisions. It is used for data aggregation and provides extra patient medical data storage. The doctor, patients, and the pharmacy department (for summary or billing purposes) can access these data. Patients may use an online interface or smartphone to display their past and current health records/bills. Data from various sources are incorporated into EHR, Electronic Medical Records (EMR), or prescription websites. As a result, doctors and patients can access the information whenever needed. It provides a notification service for any patient who uploads or receives health data .

SECURITY REQUIREMENTS OF IoMT IoMT uses wireless communication and the internet to transmit data collected from the human body to the medical server; therefore, the data in the different layers of the IoMT system, as shown in figure , are exposed to cyberattacks, which can impact the privacy of the patients and put their lives in danger. Security requirements must be met to prevent, detect and respond to these attacks in real time. This section presents the main security requirements of IoMT (Illustrated in figure ):

Confidentiality This requirement ensures that the information regarding the patient's health condition or treatment and information that identifies them are not accessible by unauthorized third parties during data storage and data communication; this ensures that the patient's privacy is protected from the disclosure of sensitive information to persons with malicious intent who may cause considerable harm to the patient . It is possible to imagine a scenario in which an adversary, who has access to the medical history of a famous person, discloses it in public to impact his/her image.

Integrity The data integrity provision for IoMT healthcare systems aims to ensure that the data arriving at the intended destination was not corrupted during wireless transmission. For instance, even a minor change to the medication or patient test results may have catastrophic implications for the patient's life. Preserving the integrity of information ensures that someone other than the person involved (i.e., doctors or nurses) does not change the medical data and, as a result, prohibits giving incorrect treatment .

Availability Despite the implementation of healthcare, clinical records of patients must be available to the doctor at all times, anywhere, without any interruption. In addition, it is crucial to respond immediately to the emergency so that the doctor can give the patient treatment or precautions. Switching from the attacked node to another node in the network may be an alternative, and this redundancy can be allowed by the network and system design .

Freshness This layer ensures that the health information is recent and that an attacker cannot replay old medical data. Two kinds of freshness are present; weak and strong freshness. Weak freshness gives the partial ordering of the health freshness message, and no delay information is provided. In contrast, strong freshness gives the complete ordering of the medical data and allows the calculation of delay . For illustration, a physician must be aware of the present patient's vital signs, such as their oxygen saturation, in order for the physician to make a correct diagnosis of the patient's health condition and provide the appropriate treatment.

Scalability Scalability is the ability of the IoMT network to function properly; as the number of devices that compose the IoMT network turn to be larger, insufficient scalability could cause security flaws. Therefore, it is essential to manage overhead computing and storage, especially in an emergency where response time is vital for the patient .

Non-repudiation Non-repudiation ensures that any entity involved in the healthcare application cannot deny the sending and receiving health-related patient information .

Authentication There are two kinds of authentication in healthcare systems: data and persons. Data authentication is the process by which the initial data source is confirmed. Person authentication in communications between patients and related servers should be checked through accurate identity authentication. Therefore, before they communicate or exchange any details, all parties need to know each other. Before doing some form of sharing, the healthcare system has to recognize each participant to ensure that the user is authorized to receive the stored data. It is, therefore, essential to know the privilege level given to the user to know the kind of data he/she may access .

Authorization Authorization is an access control used to specify permission levels for users (patients, physicians, or nurses) to enter the database of medical data. The healthcare organization must approve the patient and define the type of data that a single user can use .

Audit The audit is the inspection of changes in the system and access to the patient's medical data via the verification of log files, which are historical records of the hardware and software operating status. The audit allows the detection of abnormal activities and possible breaches. However, the management and exploitation of this type of information are delicate in practice due to the large quantity and heterogeneity of logs generated by the various medical and network equipment.

Forward Secrecy • Backward secrecy: Medical sensors who enter a network after a certain amount of time must not decode messages received before entering them . • Forward secrecy: Medical sensors that have left the network are unable to read messages received after their exit (30).

IoMT SECURITY THREAT The integration of wireless communication in the IoMT system and external equipment to control and upgrade sensors makes the IoMT vulnerable to different attacks. Moreover, two types of architecture are proposed in the literature for the IoMT: the single-hope and the multi-hope. For the single-hope, the sensors perform only data collection and transfer; however, this architecture suffers from the vulnerability of a single point of failure, which occurs when one equipment of the personal server layer fails, the whole IoMT system is compromised. The other type of architecture proposed is the multi-hope, here the sensors, in addition to collecting and transmitting data, also provide data routing, which allows node mobility and maintains low energy consumption during data transfer, like Codeblue and MIDiSN . Therefore, relevant vulnerabilities of the wireless sensors network that concern routing may apply to this type of architecture . Attacks can indirectly target devices in the personal server layer to reach patient data. The lack of data storage security in the personal and medical servers and the insecure transmission of data between these different devices can cause various security issues . It is imperative to keep these different attacks in mind when designing a secure architecture for IoMT. The different threats relateds to each level of IoMT are summarized in table 4. The most common types of network and system attacks are listed below:

Attack at Data Collection Level During data perception and delivery over a wireless channel and the ability of medical equipment to be remotely configured by external devices led the medical sensors vulnerable to different attacks. Here are the potential security threats that could take place in the following manner:

Data Modification An attacker modifies the medical data of patients to manipulate the medical diagnosis and lead to the administration of inappropriate medication, which can be dangerous for the patients.

Drain the Battery Process that leads to additional battery consumption of a medical device, which leads to battery failure .

Modify the Software of the Device An attacker can try to modify the software of the medical equipment by introducing a virus that modifies its behavior to conduct malicious actions , such as instructing the pacemaker to send an electrical charge to the patient's heart.

Jamming Attack This attack interferes with the radio frequencies that the network's nodes use. A jamming source can interrupt the whole network or part of it. It may be deliberately or unintentionally made .

Node Tampering In the case where an attacker has physical access to the IoMT nodes, they can gain access to the sensitive information on the node, for example, retrieve the encryption keys and then use them to decrypt the communications in transit. The attacker can even modify the node or replace it with a different node that the attacker controls .

Data Collision Attack When two nodes of IoMT system transmit on the same frequency simultaneously, a collision may occur, which implies a modification of the transmitted data. Therefore, the receiving node of the packet will reject it due to the checksum mismatch .

Exhaustion The collision implies that the packet lost is retransmitted; this retransmission consumes energy at the medical equipment level. The intruder could exploit the repeated collision to create resource exhaustion .

Unfairness in Allocation Collision and exhaustion attacks can be used by the intruder to create unfairness in the network, Therefore, when incoming patient data packets enter the application's processing device, they are either missed or produce multiple errors .

Attack at the Transmission Level There is a high risk of threat at the transmission level because wireless communication allows an attacker to intercept, modify, or block the messages sent and exchange valuable information related to the patient's condition. Some risks include:

Eavesdropping Due to the communication over wireless networks, all traffic is vulnerable to detection and eavesdropping by attackers. These threats may result in the loss of personal information such as physiological data and may obtain information about the medical device, such as the type of medical equipment associated with the patient. They can also contribute to other kinds of attacks. There are two types of eavesdropping: • Passive eavesdropping: By listening to the network's message transmission, a hacker will intercept the content . • Active eavesdropping: By pretending to be a friendly entity and sending requests to emitters, a hacker actively obtains information .

Man In the Middle Attack This attack happens when an intruder gets in between a patient and a server's communications and sniffs the data. They can capture all messages received between the two parties and insert new ones .

Scrambling Attacks This attack keeps the radio frequency channel for wireless communication occupied for a brief period of time; this causes patients' personal devices to be interrupted to block data transfer, resulting in vulnerabilities of losing the network availability .

Signaling Attacks In this threat, the attacker will try to disrupt the signaling operation that takes place before the establishment of a communication between two entities and involves key management, authentication, link creation, and registration by sending an additional signal, which will put a heavy load on the base station and thus interrupt its service. As a result, health data cannot be forwarded to their destination .

Message Modification Attack By capturing patients' wireless channels, the attacker can extract health data from patients, which can then be partially or fully altered before being delivered back to the initial recipient .

Data Interception Attack An attacker can capture a patient's health data when it is transmitted between two connected healthcare devices over a local area network .

Wormhole Attack In this attack, a duplicate of a patient's data packet from one location is replayed at a different location with no modifications to the data. This attack usually requires two rogue nodes relaying packets over an out-of-bound channel that is only accessible by the attacker .

Denial of Service Attack (DoS) In this attack, the intruder tries to interrupt, shut down, or stop a service from a system, machine, or a network. A distributed DoS (DDoS) attack, on the other hand, is a kind of DoS attack that originates from several distributed sources .

Hello Flood Attack The attacker must persuade all nodes to choose them as the patient's medical data routing node. A malicious node accomplishes this by sending a HELLO packet over a strong radio transmission to the network. When a node receives a message like this, it will presume that the source is within a normal radio range. Such an assumption could be wrong, since the machine of the intruder with high transmission capability could mislead the target into assuming that it is his neighbor .

Sinkhole Attack The sinkhole attack occurs when a malicious node attempts to attract all data packets in IoMT system by pretending that it is the most appropriate routing algorithm. This attack is performed to prevent data packets from reaching their destination .

Replaying Attack In a replay attack, an attacker listens to communications received between valid entities in IoMT system, intercepts them, and then sends them again to an initial recipient to alter the overall result .

Homing Attack A scan is performed in the continuous data traffic to find the key manager or the cluster head that can stop the whole network of IoMT system (49).

Data Flooding Attack This attack occurs when an attacker sends many connection requests to a target node in the IoMT network. As a result, the server exhausts its capabilities and cannot establish any other connections, even legitimate ones .

Desynchronization Attack The intruder repeatedly resends an incomplete message to one or both nodes that participate in communication within IoMT system, which requests the retransmission of the missing data. Consequently, valuable information is prevented from being exchanged between the endpoint (51).

Spoofing Attack The attacker manipulates the routing information to compromise the network of IoMT system (52).

Selective Forwarding Attack In this attack, the attacker will target a node in the IoMT network to compromise it and make it malicious, transmit some messages and block the rest. The number of messages lost will be more important if the compromised node is closer to the base station; therefore, many vital data will be wasted .

Sybil Attacks A Sybil attack occurs when a given node in the IoMT network claims several identities to act (modify) geographical routing protocols (54).

Path DoS Attack In this form of attack, the intruder produces a significant volume of traffic to the base station (51).

Overwhelming Sensors In this threat, the intruder caused the network capacity dilapidation and node resource exhaustion by overwhelming the network node with sensor stimuli, causing the network to send a large amount of traffic to the base station .

Reprogramming Attacks TinyOS' Deluge network-programming framework, for example, enables nodes in deployed networks to be remotely reprogrammed. The majority of these systems, like Deluge, are meant for use in a protected environment. A hacker will hijack the reprogramming mechanism and take possession of a vast network area if it is not secured (28).

Attack at Storage Level All information related to the patient's health condition, treatment, and identity are stored at this level, which constitutes a valuable target for adversaries to access these data. Some of the possible attacks that can occur are:

Patient's Data Inference Intruders try to recover medical records such as information about patient's health, maladies, and medications by combining information that the attacker is authorized to access with other pertinent information .

Unauthorized Access If the patient data are not protected, the attacker will attempt to access health data to conduct a malicious action such as damage it or retrieve it; therefore, it is important to secure the data against unauthorized access (55).

Malware Attack Malware (short for "malicious software") is a code or program usually spread over the network. It extracts, infects, or executes other malicious operations directed by the attacker. The types of malware include viruses, spyware, Keylogger, worm, rootkit, ransomware, and Trojan horses .

Social Engineering Attacks Phishing, spear-phishing, baiting, and quid quo pro are examples of techniques to gain sensitive information from victims. These techniques are used to dupe the user into supplying the attacker with sensitive patient information that the user assumes to be supplied to someone or something else .

Location Threats Most medical devices are equipped with a location component that allows the caregivers to have a quick response in an emergency. If this type of information is not well protected, adversaries can access it and directly invade a person's privacy .

Alert Attack Some medical devices are equipped with an alert system that notifies the medical staff of an abnormality concerning the patient's health or a device's malfunction, such as a necessary battery change. However, this feature can be abused by an attacker to create false alarms; therefore, the wrong treatment can be prescribed, the patient can make unnecessary hospital visits, or genuine alerts can be ignored, and the patient can even disable this notification functionality which has the effect of missing important notifications .

Extortion/Blackmail This type of attack consists of blocking access to medical data by an attacker and then asking for a ransom to unlock these data. It can also involve stealing influential people's personal medical history, such as a politician or a star, and then threatening to disclose it publicly if the person concerned does not pay the amount of money requested (59).

Type of Attack Attack strategies are continually changing. However, they can be divided into passive and active attacks.

Passive Attack In a passive attack, the adversaries will only listen to the traffic and thus will have the possibility to read messages exchanged between the wearable device and the remote system. By simply accessing the content of the messages, a passive attacker will directly affect the confidentiality of communication. They will have access to sensitive information such as the model, the serial number of the medical device, and capture telemetry data. They can also capture the patient's private data such as health record, name, age, and conditions. In all these cases, the result is a severe violation of the patient's privacy .

Active Attack The attacker will intercept network messages and give instructions to the wearable device, alter messages transmitted before they reach the remote system, or prevent them from reaching their intended destination. A successful intruder has a wide range of objectives. They might, for example, indiscriminately request information from the medical device to deplete its energy. They may even try to change the device's settings, bypass treatments, or even put the patient in a state of shock (34).

Attack Environment Threats to the system can be classified according to the adversary's position, i.e., internal attack and external attack.

Internal Attackers Internal attackers require that the attacker is close to the vulnerable device or nearby and has some rights to enter the network infrastructure. They may be a legitimate user, like a nurse who accesses a celebrity patient's medical data without justification. The attacker near the medical equipment can then cause physical damage or collect some information and use them to launch remote attacks later .

External Attackers In this case, the attacker does not need to be close to the medical device and does not have administrative access to the system. Instead, they will try to exploit bugs or vulnerabilities of the system remotely (13, 60).

Attackers Motivations This section discusses various attackers' motivations for targeting IoMT systems (61).

Physical Injury The compromise of medical equipment poses a severe threat, as it could be used to cause harm to patients. Malicious organizations may target patients for political or criminal reasons, and in some cases, even by terrorist groups. Such attacks can be powerful tools for criminal practices, such as extortion or coercion. For example, during his tenure, former US Vice President Dick Cheney had the wireless communication functionality of his pacemaker deactivated as a precautionary measure against potential hacking attempts (62).

Financial Profits Economic and financial profits are important motivators for attackers or rivals of Implementable Medical Device (IMD) vendors to conduct such threats. The ability of an attacker to access medical data may be used to sell it or blackmail the patient.

Privacy Violation Medical equipment collects vital information about a patient's body based on various criteria. This information may be necessary for the patient's diagnosis, care, and operational or surgical procedures. Medical data divulge information about the patient's behavior. Analysis of the data obtained from a pacemaker, for example, will reveal the patient's physical activity history. Such data can be used to distinguish general and unique patterns in the well-being of individuals/groups if collected in a large enough sample across different device types and marks. This type of information can lead to unauthorized and unethical use of sensitive data.

Tracking Messages from the Medical equipment are sent wirelessly to the system controller. These exchanges typically provide health data and position information about the patients. Attackers can intercept these communications to track or locate a patient.

INTRUSION DETECTION SYSTEM This section explains the IDS in IoMT systems according to . An intrusion is an attempt to compromise the availability, integrity, confidentiality, or defeat the security mechanisms of an end device or network. The IoMT represents information system that handles sensitive and private data related to the health data of patients, which constitutes a valuable target for an attacker to perform an intrusion. This intrusion can be performed by a remote attacker using the Internet or by a legitimate internal user who abuses their privileges, such as members of the medical team who are motivated by curiosity to access private data or an error in the handling of medical data, which could have severe repercussions to patients. An IDS is a hardware or software product that automates surveillance and analysis of events that occur in an end device like IMD or network to detect signs of intrusion. An IDS consists of three parts: information source, analysis, and response. An IDS can use several information sources to perform a pre-configured analysis on them. When an attack is detected, the IDS generates a response that can be passive or active. A passive response implies issuing a notification. An active response does an action such as interrupting communication. The purpose of an IDS is not to find out who conducted the attack. Instead, it is to interrupt it because the attacker's identity may be hidden, making it difficult to Recognize. An IDS differs from other security mechanisms, such as a firewall or an antivirus, in that IDS monitors network traffic and analyzes events to identify potential threats, while firewalls and antivirus software primarily focus on blocking or detecting known threats. However, each security mechanism has its advantages and disadvantages, and their combination can provide in-depth security capable of protecting information systems from various security threats. Several types of IDSs are classified based on their monitoring approach, information source, type of analysis performed, and response time. There are network-based IDS for the monitoring approach and host-based IDS. Networkbased IDS monitors network packets by listing network segments. Host-based IDS is designed to monitor events and activities on individual end devices, including the operating system, audit trails, system logs, and other data sources, such as medical records. There is also an application-based IDS, a subdomain of the host-based IDS, which monitors the application transaction log file generated by applications to perform attack detection. There are two types of analysis methods used by IDS: misuse detection and anomaly detection. Misuse detection identifies attacks by matching the analyzed event to predefined patterns, which ensures high accuracy. However, this method cannot detect new or zero-day attacks, and new attack signatures must be added to the predefined templates continuously. On the other hand, anomaly detection identifies suspicious behavior by learning the normal operating pattern of the system using historical data. Any deviation from this normal behavior is flagged as potentially malicious. This method has the advantage of detecting new vulnerabilities and zero-day attacks. However, it can generate many false positives and requires a large training set to build the normal profile. The response time of IDS can be real time or interval-based. There are several possible architectures for IDS: centralized, fully distributed, and partially distributed. In a centralized architecture, monitoring, detection, and reporting are performed in a central node. In a fully distributed architecture, the response to an intrusion is carried out in the part of the network where monitoring is conducted. In a partially distributed architecture, the reporting is executed hierarchically.

MACHINE LEARNING OVERVIEW ML is a subfield of AI that gives a machine the ability to learn from data without explicitly programming it . ML has proven efficient for problems requiring a long list of rules and complex problems where traditional approaches are inefficient. Also, ML shows a great capacity for adaptation to new data, especially in a changing and evolving environment such as the IoT system. ML has also shown a great ability to obtain insights from large volumes of data . These ML capacities can be used to enforce security in the IoMT or at least improve it. Some studies demonstrate that using ML in IDS effectively detects zero-day attacks and new vulnerabilities, while IDS that rely on rules and signatures can only detect known attacks. ML can also be used to learn the behavior of a person or an object by using the data generated to create a socalled normal profile, so any behavior that deviates from the normal profile is considered abnormal and consequently is detected, this is what is done in the field of anomaly detection. Three types of ML can be used to solve security problems in the IoMT: supervised learning, unsupervised learning, and semi-supervised learning. For supervised learning, the training data are labeled. The relationship between inputs and their appropriate output is captured. For this, there is a need to train a model with labeled inputs, which are used to predict or classify new data . There are two types of supervised algorithms, which are regression and classification. The regression predicts the next continuous value based on the previous ones. On the other hand, classification predicts discrete variables and separates the data into different categories. Examples of the techniques that can be used for regression and classification are Support Vector Machine (SVM), Decision Tree (DT), Random Forest (RF), Naive Bayes (NB), and artificial neural network (ANN). Unsupervised learning involves training ML models on unlabeled data, as manually labeling data can be challenging and time-consuming. Instead, unsupervised learning algorithms analyze the data and identify patterns, relationships, or groupings among the data points. Some popular unsupervised learning techniques for clustering data include Kmeans, k-Nearest Neighbor (KNN), and Self-Organizing Map (SOM). Unsupervised learning can effectively divide large datasets into meaningful clusters to aid further analysis or decision-making . While obtaining unlabeled data is often straightforward, leveraging its potential can be a significant challenge. Semi-supervised learning presents a solution by incorporating labeled and unlabeled data to build ML models that can classify data with improved accuracy. Compared to traditional supervised learning, semi-supervised learning reduces the need for manual labeling while producing models with greater accuracy. As a result, this approach has a special place in theoretical research and practical applications . DL is a subdomain of ML, and it is inspired by the functioning of the human brain to process the signal. DL enables computational models with several layers of processing to learn data representation with several levels of abstraction . DL differs from classical ML in its ability to capture the relevant feature previously done manually and required human intervention. Another advantage of DL compared to traditional ML is its performance on a large dataset. Therefore, this method is perfectly adapted to IoT systems and their applications, such as IoMT, which generates a huge volume of medical data. There are three types of DL: supervised example Convolutional Neural Network (CNN), unsupervised example the Deep Autoencoder, and finally, the combination of these two types, which is the hybrid DL, example ensemble of learning networks.

REVIEW OF MACHINE LEARNING APPLICATIONS FOR IoMT SECURITY Health data are sensitive and can attract the attention of attackers for various reasons mentioned in section 5.6. It is essential to protect medical data from threats by adopting a solution that ensures the security of this data during collection, transfer, storage, and processing. Protecting patients' privacy from unauthorized access is also necessary to avoid disclosing sensitive information to malicious entities. In addition, security solutions must consider the computational, storage, and energy limitations of medical devices and the heterogeneity, dynamics, and quantity of medical data generated within the IoMT system. In light of these constraints, ML has the potential to provide a solution for intrusion detection. This section reviews the papers that have proposed a security solution based on ML for the different IoMT layers, specifying their objectives, the method employed, the dataset used, and the results obtained. Tables , , and 7 summarize the papers explored in this review, mentioning the methods, applications, advantages, disadvantages, and dataset.

ML for Data Collection Level Security Sensors associated with patients allow constant monitoring of their health status and automatic medication for people suffering from chronic diseases. This technology, despite its advantages, must be protected against security threats due to the wireless transmission of medical data to a personal server and the possibility of configuring the medical equipment via a programmer device, which increases the surface of the attack. These security threats can be either intentionally caused by hackers or unintentionally caused by the environment due to interference. Patients need a security solution that detects such threats, differentiates them from emergency cases and avoids lethal doses of medication. Among the different medical devices that researchers have investigated to provide a security solution, there are cardiac implants that provide electrical impulses to stimulate the cardiac muscles in case of abnormalities in the heart rhythm. A well-placed attacker can cause an electrical impulse that can be fatal for the patient. To avoid this kind of situation, the researchers (Kintzlinger et al., 2020) in proposed a system that detects and prevents cyberattacks against ICD. It is implemented at the level of the programmer's device. The Cardiwell is a decision aid for doctors that, in case of detection of an anomaly, generates an alert with the necessary details that allow the doctors to decide then if they pass the programmer commands. The Cardiwell is a multi-layer Security scheme, and it consists of six layers of security. The first five layers use rules and statistics, while the sixth layer uses the method of one class SVM, which is based on ML. To validate their solution, tests were performed on a dataset collected from volunteer patients from different hospitals and clinics over four years. This dataset consists only of benign programmer commands sent from a programmer device to an ICD and which represent a total of 775 samples, while experts generate malicious programmer commands and represent a total of 28 samples. After performing the different tests, the best results obtained are True Positive Rate (TPR) = 0.914, False Positive Rate (FPR) = 0.101, and Area Under the Curve (AUC) = 0.947. However, layers three to six are inefficient and do not participate in improving the results, which according to the authors, is due to the poor datasets that need to be enriched. The study by , as described in , presents a novel approach for detecting abnormalities in Electrocardiogram (ECG) data. The authors proposed a centralized solution and chose a simplified Markov model-based detection mechanism due to the changing nature of ECG data over time. The proposed approach involves extracting attributes from the ECG data, followed by reducing the dimensionality of the dataset using the discrete wavelet transform. The reduced dataset is then partitioned into sequences, and the probability of each sequence is calculated to determine if any changes have occurred. If an abnormality is detected, the system associates an abnormal tag with the corresponding data and forwards it to the hospital server for further evaluation by nursing staff. The evaluation process is designed to determine the normality of the received data. To test the efficacy of their approach, the authors utilized a dataset from MIT-PHYSIOBANK and introduced 5% and 10% of attacks composed of forgery, unauthorized insertion, and ECG data modification. After conducting the experiments, the authors achieved a high detection rate, reduced training time, and a high TPR. Other researchers have studied the security of the insulin pump system, which allows the automatic administration of insulin according to the amount of glucose in the patient's blood. However, an intruder can cause a lethal insulin administration if the device is compromised. In this perspective, the researchers in addressed the security gap between the Carelink and the insulin pump, two components of the insulin pump system where the attacker can carry out two types of attacks; the first one is the bolus dose where the attacker delivers a large amount of insulin in a short period. The second possible attack is the basal dose, where the attacker delivers an insignificant amount of insulin over a long period, which can threaten the patient's life. To address these issues, the authors propose to use a supervised ML algorithm using SVM with a regression method to learn the normal insulin dosage of each patient at different parts of the day. The authors collected insulin pump log files from four patients over six months to generate the dataset. Each log entry is composed of infusion rate, dosage, blood glucose level, patient ID, and time of day for each infusion. After performing different tests, the authors obtained better results with the non-linear SVM than the linear SVM by getting a score of 98% of success rate in detecting a single overdose attack and a high success rate in chronic overdose attack detection. The authors propose deploying the model with an update every 90 days. In the case of anomaly detection, an alert message is raised. The authors have also defined a value of insulin that, if exceeded it, indicates that the patient is in an emergency and, therefore, the system is deactivated. In another study made by in , The authors proposed to secure the insulin pump against attacks that aim to alter the functioning of its system to deliver a lethal dosage of insulin to the patient. To address this issue, the authors propose using Long Short-Term Memory (LSTM), a DL algorithm, to define a threshold value for the insulin dosage delivered to the patient. If the insulin dosage value exceeds the threshold value, the system calls the patient to perform a gesture by raising the thumb or spanking it down, which is captured by a gesture sensor. The authors propose to use a gesture sensor because they assume that the patient can feel and judge the significant change of insulin in their body through symptoms like nervousness, trembling, and weakness. Therefore, depending on these symptoms and the dose of insulin to be administered, the patient can accept the insulin dose by raising the thumb or refusing it by lowering it. To test their solution, the authors used a dataset containing log files generated by the insulin pumps system over the last three months to train and test the LSTM and determine a threshold value. In a study conducted by ) in ( ), the authors proposed a solution for detecting fake glucose measurements in the entire insulin pump framework, which comprises a continuous glucose monitoring system, a sensor, a transmitter, an insulin pump, a remote control, and a one-touch meter. The authors proposed a solution that uses the Multi-Layer Perceptron (MLP), a DL algorithm, to classify glucose measurements in the blood as genuine or fake. To evaluate the effectiveness of their solution, the authors used the Pima Indians Diabetes dataset (72) and achieved 93.98% of accuracy. Furthermore, the authors employed the NB algorithm to test the reliability of their system and obtained a success rate of 90%. According to the authors, this high success rate is due to the deployment of their model on a chip using Field Programmable Gate Arrays (FPGA), which can be integrated into any equipment used in the insulin pump framework, thereby securing it against erroneous blood glucose measurements. So far, the methods used to secure the insulin pump system are based on supervised learning methods. However, the study conducted by in proposed using an IDS based on unsupervised ML to secure the insulin pump injection against four generated attacks: Long Resume, Single Acute Overdose, Underdose, and Chronic Overdose. For this purpose, the authors proposed using a deep autoencoder and a DL algorithm to classify the logs generated within the medical equipment. To test and evaluate their solution, they applied their method to the Diabetes Data Set . They measured the model's performance in terms of accuracy, precision, F1-measure, and recall. The results obtained exceed other traditional ML methods and previous work. In a pioneer work carried out by (Rathore et al., 2019) in ( ), a solution based on ML was proposed to enhance the security of DBI. A DBI comprises a quadripolar electrode implanted in the human brain, an Implementable Pulse Generation (IPG), and a controller that switches on/off the medical device. Some IPGs are customizable to modify voltage levels. The primary function of the DBI is to regulate the Rest Tremor Velocity (RTV) by maintaining its value at zero through electrical charges. Movement disorders and chronic diseases like Parkinson's arise when the RTV deviates from zero. An attacker with access to the DBI can attempt to modify the RTV's value, thereby seriously endangering the patient's life. To address this issue, the authors modified the RTV value to simulate various attacks. They proposed to use LSTM, a DL algorithm, to predict the RTV value at time T. By detecting and classifying any deviations from the predicted RTV value, the proposed solution can prevent potential attacks on the DBI. To create and test the model, the authors used a dataset obtained from Physionet , which contained 173,398 samples with ten features. However, the authors focused primarily on the RTV attribute, considered the most critical attribute since its modification by an adversary could have detrimental effects on the patient. After conducting various tests, the model efficiently classified attack strategies with minimal loss values and training times. The solutions explored so far have focused on securing a single medical device. This section reviews more general solutions that include multiple medical devices. In this regard, in suggested adding a security layer for IMD by using patient IMD access pattern and SVM. This solution prevents authentication requests from illegitimate programmers or readers, saves energy, and counters attacks that drain IMD energy resources. If the IMD's battery power is depleted, surgery is required to replace the battery, which can be life-threatening. The additional security layer implements a ML-based cell phone model using SVM that classifies authentication requests from readers. Depending on the response of the cell phone, three situations are considered: 1) in case the request is classified as benign, then the IMD can perform the authentication with readers, 2) in case the request is classified as malicious, then the IMD put itself on standby to not waste more energy. 3) If the model fails to classify the request, the decision is left to the patient, who can authorize or deny the authentication request. For the emergency, the authors suggest assigning a value to cardiac implants that signify a critical condition for the patient when reached. In this case, they suggest either disabling the classification or using a backdoor accessible via a key shared between the IMD and the authorized persons to guarantee access to the implant. The dataset used to create the model consists of 3000 entries, of which 2500 are used to train the model and 500 to test it. The dataset is composed of five attributes which are the reader action type which determines the type of action that the reader wants to perform on the IMD, a time interval of some reader's action, location (home, hospital, pharmacy), time, and day (weekend, weekday). After performing the different tests, they obtained an average accuracy of 90% for the linear SVM and 97% for the non-linear SVM. Other researchers in ( ) presented a secure framework to detect malicious activities in the Smart Healthcare System (SHS). The proposed framework uses different ML: ANN, DT, RF, and KNN, to detect malicious activity in the SHS. The data used to evaluate their framework are collected from eight different databases. The dataset obtained contains 20,000 samples, of which 17,000 represent data from healthy people and people suffering from diseases, and 3,000 represent attacks that simulate three different threats, which are compromised medical devices, DoS, and false data injection. After performing the tests, they obtained 91% accuracy and 90% f1-score. In another work carried out by in , they proposed a centralized Markov chain-based solution for the detection of anomalies from the data collected by biosensors in WBAN that is composed of sensors and a Local Processing Unit (LPU). In the proposed system, only the measurements captured at the sensors that deviate from the expected values are communicated to the LPU, reducing energy consumption caused by the transmission of routing data. The proposed method is based on a Markov Model (MM) constructed based on the Root Mean Square Error (RMSE) between the forecasted and measured value for complete attributes. The method intends to work with LPU to detect abnormal deviations in the gathered data and reject erroneous or added measurements. After detecting physiology-related changes and removing erroneous or inserted measures, the system alerts the healthcare staff. To test and evaluate their system, the authors used a public dataset containing real data obtained from Physionet . After performing the different tests, the authors obtained 100% TPR while maintaining a low False Alarm Rate (FAR) of 5.2%. They also compared their approach with other existing methods that use the Markov chain for ECG anomaly detection and other supervised ML algorithms: SVM, KNN, J48, and the distance-based method. The system proposed in this paper exceeds the MM-based ECG abnormality detection system by a small margin and outperforms the ML methods regarding accuracy. After reviewing the different solutions of security based on ML for data collection level, most of these researches are focused on the security of cardiac implants and insulin pump injection systems . There is just one study based on the security of DBI . However, other medical implants use wireless communication and are not yet investigated, such as the Gastricelectrical stimulator. This medical device stimulates the smooth muscles of the lower stomach equipment to help control chronic nausea and vomiting associated with Gastroparesis. This equipment uses wireless communication that suffers from a lack of encryption, authentication, validation mechanism, and Hardware/Software error , making it vulnerable to different attack types, including eavesdropping, information disclosure, tampering, jamming, and resource depletion . Therefore, it must be considered when the researchers conceive an IDS for multiple medical devices. -The solution is implemented on an external device (cell-phone) that can be stolen, lost or simply forgotten by the patient -Need software modification of the medical device -At each authentication request, the IMD forwards this request to the cellphone, which causes the IMD to consume energy and must be taken into consideration -This scheme is not designed to support emergencies -The protocol used between the cell-phone and the IMD is not secure -Their solution is not holistic since it is tested against only one type of vulnerable device -The patient must make a decision if the classification is not accurate -Not mentioned -Not available (Newaz et al., 2019) (77) ANN, DT, RF and KNN Detection of malicious activity in the smart healthcare system -High accuracy and f1score -Computation and detection time considered -Overhead is not calculated -The FPR metric is not mentioned -They did not specify where this solution is deployed -Use different datasets Continue on the next page

ML for Transmission Level Security The transmission of medical data between devices composing the IoMT and the server enables the remote healthcare system to continuously monitor and treat patients in real time. However, the sensitive nature of the data exchanged represents a high interest for cyber-attackers, who, in case of a successful attack, can cause severe repercussions for the patient, ranging from violation of privacy to death. In addition, the heterogeneous nature of the devices used increases the surface of attack, which requires the design of a secure architecture for the IoMT. One such proposal was made by (Gao and Thamilarasu 2017) in their paper . Their proposed solution involves using ML methods to detect attacks targeting connected medical devices by learning the normal behavior of the device and identifying any deviations from it. The ML model is deployed on an external device that monitors the network and alerts the patient if an anomaly is detected. To test the effectiveness of their solution, the authors used three datasets of different sizes generated by a Castilia simulator and evaluated the performance of DT compared to SVM and k-means. After conducting various tests, the authors found that DTs provided higher accuracy, generated fewer false positives, and had a faster training and prediction time. In another work performed by (Al-Shaher and al., 2017) in , they proposed to protect the private healthcare system from known viruses, worms, spyware, and denial-of-service attacks by designing and implementing an Intelligent Healthcare Security System (IHSS). The IHSS integrates the firewall, network intrusion detection subsystem, and web filter. The IHSS is intended to enhance the capabilities of these network protection systems using artificial intelligence approaches. The authors use MLP activated by wavelet transform to classify network traffic. The intrusion detection subsystem uses a wavelet neural network to determine which type of attacks are occurring by solving the multi-class problem. In web filters, they use Wavelet Neural Network to detect malware. After evaluating their method, they obtained 93% accuracy with two hidden layers and 90% with one hidden layer. Other research group proposed an IDS based on a stacked Autoencoder for anomaly detection in the Connected Healthcare System, as outlined in their publication . The method involves several stages of data processing, including mapping, discretization, and normalization, before feeding the data to the stacked Autoencoder. The Autoencoder is used to extract the relevant features, which the ML models then use to perform detection and classify the data as either an attack or not. To evaluate the performance of their IDS solution, the authors collected a real dataset from patients and simulated various types of attacks, such as DoS, counterfeit attacks, temper attacks, and replay attacks. They compared the performance of different ML models, including SVM, NB, KNN, and XGBoost, using metrics such as accuracy, FPR, and FNR. After conducting several tests, the authors found that the XGBoost model achieved the best performance with 97.83% accuracy, 2.35% FPR, and 1.65% FNR. Other researchers in presented HEKA an IDS based on ML for personal medical devices (PMD). The traffic generated between the PMD and the smartphone is analyzed with a sniffer to detect possible attacks using ML. The n-gram extracts feature sent to the IDS composed of four ML (KNN, DT, RF, and SVM). The HEKA is tested against four types of attacks, including a Man-In-The-Middle (MITM), false data injection, Replay, and DoS individually, then combining MITM and false data injection, and finally, MITM and Replay. They use eight devices composed of four PMDs (iHealth Air Wireless Pulse Oximeter, blood pressure monitor, QuardioArm blood pressure monitor, and wireless weight scale). The final dataset is composed of 731 benign instances and 308 malicious instances. After the realization of the different tests, they obtained a score of 98.4% accuracy and 98% F1-score. In a recent study conducted by (RM et al., 2020) , a new approach was proposed to develop an IDS based on DL to predict and classify cyber attacks in the IoMT using a unique IP address. The proposed methodology aims to reduce the number of features and instances required for the classification process. This was achieved by transforming the categorical data into numerical data using one-shot coding, then normalizing it to a value between 1 and 0. Then, the normalized data is reduced using principal component analysis (PCA) at the first level and gray wolf optimization (GWO) at the second level, extracting only the most important features. The reduced dataset is then ranked using a DL algorithm using deep neural networks (DNN). To evaluate the effectiveness of their proposed solution, the authors used a dataset obtained from Kaggle containing data collected by a wireless sensor network. They compared the performance of their methodology with other commonly used ML algorithms, including KNN, NB, RF, and SVM, using the measures of accuracy, specificity, and sensitivity. After performing various tests, the study found that the proposed methodology improves IDS accuracy by 15% and reduces learning time by 32%. These improvements would enable timely alerts to be generated in the event of healthcare system intrusion detection. In another work carried out by in , they proposed an IDS using ML and multi-class classification for the healthcare IoT within the smart city. The authors used CNN as an ML method to classify the network events generated by different medical devices into four classes, namely (critical, informal, major, and minor). Before the data are fed to the model, the data are preprocessed by transforming the categorical data into numerical data, then normalizing the data to take values within the same range. To evaluate their model, the authors generated a dataset by collecting data from six medical devices and then used them to compare their model results with other ML models regarding AUC, F1-score, Precision, and Recall. After performing the different tests, the authors found that their CNN model produces better results than other ML methods. In another work performed by , they presented a novel approach for predicting Distributed Denial of Service (DDoS) attacks in healthcare systems, as opposed to merely detecting them . The authors demonstrated that DDoS attacks cause traffic data to become chaotic, which can be analyzed using the Lyapunov Expansions Analysis and the Echo State Network. To implement their approach, the authors first represented network traffic as time-series data and applied a simple exponential smoothing method to predict future traffic. They then calculated the time-series prediction error by subtracting the predicted data from the actual data, which served as the basis for DDoS attack analysis. The authors then utilized a recurrent neural echo state network to predict the time series and used the LEA-MA method to detect the DDoS attack. To evaluate their method's effectiveness, the authors tested it on the DARPA 98 dataset and used metrics such as precision, recall, and F1-score. Their experiments showed that their proposed method could efficiently predict DDoS attacks. In the following, a distributed IDS within the IoMT systems are presented as a solution. Among these solutions, there is work made by (Thamilarasu and Odesile 2017) in . They proposed an approach that utilizes mobile agents to conduct penetration testing and secure the medical equipment network. The proposed system is characterized by its hierarchical, autonomous, and distributed nature. Intrusion detection is performed using a regression algorithm at the medical equipment level and ML techniques at the network level. Mobile agents traverse from one node to another or within a cluster, collecting network activities or device data based on their role as network or device intrusion detection agents. At the end of an intrusion test, the mobile agent classifies the collected samples as voluntary, malicious, or suspicious. The mobile agent migrates to another node if the samples are classified as voluntary. However, if the samples are malicious, an alarm is generated, and the data is sent to the cluster head. If the samples are suspicious, a request for intervention is sent to the cluster head. The cluster head deploys a special agent to collect data from the network or medical equipment of the entire cluster. The collected data are then tested to determine whether they are benign or malicious. Additionally, the system incorporates a security mechanism to detect intrusion at the cluster head level, which is achieved by using the cluster head agent that performs anomaly detection while traversing the cluster head network. The authors evaluated their proposed solution using OMNeT Castalia 3.2 simulator (82) and tested five ML algorithms (SVM, DT, NB, KNN, and RF) to detect anomalies at the network level. Based on the accuracy, Cost Ratio, Feedback Reliability, training time, Total Rank Score, and Energy Overhead, DT produced the best results. Moreover, to detect anomalies in devices, the authors employed a cubic model of polynomial regression that balanced accuracy, overfitting, and computational resources. Finally, the proposed system was tested in a simulated hospital network topology and showed high accuracy, low overhead, and scalability. Furthermore, in another study reported by , a framework for securing remote healthcare systems was proposed . Given the distributed nature of such systems, the authors employed multiple agents, each categorized based on their energy consumption and sensitivity to security risks. The resulting framework consists of three agent classes: sensors, smartphones, and databases. The first class, comprising sensors, utilizes a non-linear SVM-based anomaly detection approach, which consumes less energy and is effective for the limited data available from sensors. The second class, including smartphones with higher energy autonomy, uses a misuse-based intrusion detection system. The third and most critical class, which involves databases storing sensitive patient information, uses a hybrid detection system based on anomaly and misuse detection methods, as it is more prone to attacks and therefore has the highest security requirements. The authors evaluated the framework using the NSL-KDD dataset to detect various attacks, including DoS and user-to-root. The results demonstrated the effectiveness of the proposed framework, with efficient execution time, low energy consumption, high accuracy, and a low number of false positives. In more recent studies, researchers explore other architectures that can be used in the context of IDS in IoMT systems: fog-cloud, SDN, and federated learning. In this regard, the work carried out by in ( ) developed a framework for detecting attacks in fog nodes . The authors used Online Sequential Extreme Learning Machine (OS-ELM) due to its fast learning speed. However, since OS-ELM produced inconsistent results, the authors employed a set of OS-ELM and employed majority voting to determine the presence of an anomaly. Prior to applying the ensemble of Online Sequential Extreme Learning Machine (EOS-ELM), the authors preprocess the data by converting discrete values into numerical values. Subsequently, they utilized the Information Gain algorithm and voting method to select features, then normalized the chosen attributes to values between 0 and 1. To evaluate and test their framework, the authors utilized NSL-KDD . After numerous tests, the authors found that EOS-ELM outperforms extreme learning machine, OS-ELM, and ML regarding accuracy, detection rate, and FPR. A recent study made by in proposed an IDS that utilizes ensemble learning and a fog-cloud architecture to detect cyber-attacks in IoMT networks. The system preprocesses traffic data by converting categorical values into numerical values, replacing missing values with the mean of the corresponding feature values, and selecting the relevant features for intrusion detection using the correlation coefficient method. The numerical values are then normalized using the min-max technique to ensure they fall within a specific range. The system uses a learning set consisting of NB, DT, and RF algorithms, which produce three prediction outputs. These outputs are then fed to XGBoost to produce the final output using majority voting. When an intrusion is detected, the administrator is alerted. The framework is deployed using a fog-cloud architecture, which utilizes Software as a Service at the fog level and Infrastructure as a Service at the cloud level. The authors evaluated their framework using the Ton-IoT dataset , representing data collected from heterogeneous and large-scale IoT networks. The evaluation metrics were accuracy, detection rate, precision, FAR, and F1-score. The results show a detection rate of 99.98%, an accuracy of 96.35%, and a reduction of up to 5.59% of the FAR. These results surpassed those of previous studies that used In another research made by in , they proposed to use of deep hierarchical stacked neural networks to detect attacks that would attempt to modify the data flow, including meta-information that transits between the gateways and the edge cloud and between the edge cloud and the core cloud within multi-cloud healthcare systems called MUSE. This method includes reusing the edge cloud's trained layers to merge them and form a pre-trained model at the core cloud level. The tests were performed on three different datasets: UNSW-BOT-IoT and UNSW15 and one generated by the authors. A comparison was made with the method that does not reuse the trained layers of the edge cloud. The results show that the solution proposed by the authors improves the training efficiency and accuracy with a rate that varies between 95-100% and reduces the training time by 26.2%. The proposed IDS solution at the fog level has the advantage of being close to the IoT devices and therefore offers a rapid response, decentralization and preserves data privacy. However, the fog level faces an increase in the amount of data arriving at the fog level, which requires a lightweight solution. For this purpose, in proposed to use an incremental ensemble learning method called Weighted Hoeffding Tree Ensemble system consisting of an incremental learning classifier for the industrial IoMT. Tests on NSL-KDD and ToN-IoT (94) datasets and comparison with single incremental classifiers and Bagging Hoeffding Tree ensemble algorithms show that the proposed solution is lightweight and presents a trad-off between accuracy and overhead (CPU, memory and time) and outperforms the results of previous studies. Other works have proposed SDN as an architecture for ML-based IDS within IoMT systems. Among them is the work led by (Khan and Akhunzada, 2021) in , which proposed a hybrid model based on DL for malware detection in IoMT deployed at the SDN plane application level. The system proposed by the authors consists of feature extraction using CNN, and then LSTM is used to classify the data as malware. The authors used the current state-of-the-art IoT malware publicly available dataset to evaluate their model. In addition, they compared their model with the constructed hybrid DL-driven. After performing various tests, the authors found that the proposed model outperformed the other methods regarding detection accuracy and speed efficiency. In another study, in proposed to use IDS based on ML to secure the IoMT architecture based on SDN against cyber threats. For this purpose, the authors propose using a hybrid model combining the LSTM and GRU deployed at the SDN control plane. The tests were performed on the CICDDoS2019 dataset , which was subjected to a preprocessing consisting of eliminating the missing value, transforming the non-numeric values into numeric values, applying the one-hot encoding to output label, and then using MinMaxScaler for data normalization. They compared the results with other classifiers: cu-GRU, DNN, and cu-BLSTM, as well as other previous studies. The findings indicate that their solution outperforms other models and prior studies in terms of accuracy, precision, F1-score, and execution time. The various IDS solutions proposed to improve the security of the IoMT network do not include measures to protect patient privacy. In this perspective, the research realized by in proposed to use an IDS based on ML and federated learning to secure medical cyber-physical systems composed of sensors, mobile devices, and servers. The distributed and scalable nature of this system makes it more effective in protecting patient data privacy. The proposed IDS system follows a process where mobile devices first register with the server and are assigned to a cluster based on their health history. This cluster is associated with a federated model stored on the server. Each mobile device downloads the federated model, trains it, and updates it using patient data. The server then selects some or all of the mobile devices that compose the cluster and asks them to send their updated model. The server then calculates the average weights and biases of the received models to update its federated model, which mobile devices can download. This process continues until the model converges. Mobile devices can be in two modes: testing and learning. In learning mode, the mobile device can predict and send its updated model to the server. In the testing mode, the mobile device can only predict the new data and does not send the model to the server, saving communication costs. The proposed system allows the detection of anomalies, such as a value of an attribute that exceeds its usual value range or has an unexpected correlation with other attributes. In these cases, an alert is generated on mobile devices, allowing the nursing staff to react. The system was tested using the MIMIC dataset from Physionet , with the addition of simulated attacks such as DoS, data modification, and injection. The performance metrics used to evaluate the system were detection accuracy, FPR, recall, F1-score, training time, and communication overhead. The tests produced high detection rates and low false positives, with training times equivalent to or better than using a single ML. Additionally, increasing the number of patients does not affect the training time, which improved the accuracy and decreased the FPR by obtaining more data. In another study made by in , the author proposed a solution for intrusion detection at the IoMT networks level using Hierarchical Federated Learning (HFL) based on hierarchical long-term memory. Their solution is deployed on the distributed dew servers of the IoMT framework, with a backend supported by cloud computing at the edge layer. The proposed HFL solution aggregates models from different entities that compose the healthcare institution at the dew-servers level to obtain local models. These local models are then aggregated at the cloud computing level to obtain the global model, which is redistributed to the different dew servers participating in the learning process. This iterative process is repeated until the global model achieves a high accuracy. The authors evaluated their solution on TON-IoT and NSL-KDD (92) datasets. They preprocess the datasets by removing unnecessary features, converting non-numeric values to numeric, and applying one-hot encoding to categorical values before normalizing the data to ensure they are represented in the same range. Finally, they applied PCA for dimensionality reduction. The results showed high accuracy, precision, recall, and f-score compared to Recurrent Neural Network (RNN), Gated Recurrent Unit (GRU), LSTM, and the previous study, with minimized computation costs. The previous ML models lack interpretability and do not explain how they detect attacks, making them black-box models. However, presented a solution to this issue in their study . They utilized Simple Recurrent Units with skip connections to avoid the vanishing gradient problem for detecting network attacks in the IoMT, which was deployed at the gateway and router levels. To increase trust in their model, the authors employed Explainable AI (XAI) design using the Local Interpretable Model-Agnostic Explanations model to interpret and explain how the model classifies the data. The evaluation was performed on the ToN-IoT (94) dataset, which underwent preprocessing such as labeling categorical data, normalizing data to the same scale, and applying PCA for dimensionality reduction. The results indicate that the proposed solution by the authors is more efficient than two RNN variants: LSTM and GRU, in terms of Accuracy, Precision, Recall, and F-measure. Additionally, the proposed solution has a reduced computation cost compared to previous studies. Furthermore, XAI revealed that the basic category of IoT device features significantly impacts data classification. The datasets used to evaluate the ML models in the above solutions consist of either network or medical data. The research performed by in , proposed an IDS for healthcare that uses medical and network data. For this purpose, the authors developed an architecture that allows the creation of a dataset containing medical and network data and simulated MITM attacks to perform two types of attacks: spoofing and data alteration. The generated dataset ( ) is used to test and evaluate different ML methods: SVM, KNN, RF, and ANN, with the following metrics accuracy, AUC, and time of execution for training and testing. After performing the different tests, the authors found that their system, which combines medical and network data increased the effectiveness of ML methods by 7 to 25% for the detection of threats in health monitoring systems in real time. A literature review reveals that current proposals for using IDS based on ML in the IoMT environment have mainly explored centralized architecture solutions . However, some researchers have also investigated distributed solutions . Incorporating IDS and blockchain technology to achieve a decentralized architecture in the IoMT setting presents a promising direction for future research. Since it can bring numerous benefits to the IoMT environment, for example, it can enhance security by removing the risk of a single point of failure, making it difficult for malicious actors to alter data. The immutability of blockchain technology also ensures that data is recorded permanently, providing a trustworthy record of transactions. Decentralization can also improve traceability and reduce dependency on intermediaries, leading to more efficient and transparent processes. However, several challenges are also associated with using blockchain technology in the IoMT environment. Scalability remains a significant concern, as current processing speed and storage capacity limitations may not be suitable for large-scale applications. Additionally, the energy consumption associated with proof-of-work consensus algorithms can negatively impact the environment. Finally, the lack of standardization across different blockchain platforms can limit interoperability between them. The future solution must prioritize protecting patient privacy, provide interpretable and explainable ML models, and apply appropriate learning and testing processes using a custom-designed dataset in an IoMT environment. Adherence to these requirements will ensure the development of a secure, transparent, and trustworthy IDS solution for the IoMT setting, which is critical in today's increasingly connected healthcare ecosystem.

ML for Storage Level Security Medical data received from sensors are centralized in a medical server, which the medical staff can access for analysis. These stored data are of two types: the EMR and the EHR. EMR stores a patient's medical and treatment history in a single place and makes it accessible at a single hospital. While EHR focuses on the patient's general health, it can store and transmit the patient's health data, such as patient history, medication, test results, and demographics . It is necessary to secure access to these data to preserve patients' privacy, protect the confidentiality of medical data, and guarantee their availability and integrity to make an accurate diagnosis. In this perspective, in proposed to use statistics and ML to identify suspicious access in EHR access logs. The authors used Logistic Regression (LR) and SVM to classify new access as suspicious with ranking. The high-scoring event is investigated first by the privacy officers. To create the model based on LR and SVM, the authors used the privacy agent to label the selected events as suspicious or appropriate using an iterative refinement process. Then they trained the model using 10-fold cross-validation. The authors used sensitivity, AUC and compared their model with the rule-based technique to evaluate their model. After performing several tests, the authors obtained more than 0.90 of AUC and more than 0.75 of sensitivity. They find that using a method based on statistics and ML to detect suspicious access in EHR is possible and is more effective than a rule-based technique. For the same purpose, a different approach is proposed by in for detecting privacy violations resulting from inappropriate access to EHR. The authors use an approach inspired by collaborative filtering for inappropriate access detection, where the objective is to predict a label for a pair of entities interactions. Their solution incorporates explicit and latent features for staff and patients, allowing for the generation of a fingerprint customizer for users based on previous access history. To evaluate the model, the authors used two datasets named "hospital" and "amazon" (109) using the following metrics: RMSE, the area under curves, and precision-recall curves, then they compared the results obtained with three ML algorithms: linear regression, LR, and SVM. After performing the different tests, the authors improved the performance considerably over the other approaches and detected inappropriate access. Furthermore, the work performed by in proposed an unsupervised learning model for insider threat detection in a collaborative environment using access logs called a community-based anomaly detection system. The approach proposed by the authors is hybrid; they use singular value decomposition, a special case of PCA, to infer communities from relational networks of users, and then they use KNN to create a set of nearest neighbors. The created model detects anomalous users by identifying users who have diverged from typical communication behaviors. To evaluate their model, the authors used two datasets: a six-month collection of access logs from an actual EMR and another dataset that reports the editorial board composition for a set of journals over five years. After running the different tests, the results showed that their model could detect the simulated user with high accuracy, outperforming other anomaly detection models. Another work carried out by in , presented a new approach to secure image data processing in the cloud environment based on ML. Their method consists of segmenting the image into four distinct parts depending on pixel intensity level using Fuzzy C-Means Clustering (FCM) and SVM. The FCM is utilized for extracting color features at the pixel level. These features are fed to the SVM to be classified into different regions, allowing storage of the image in the cloud in a segmented format. The authors have also proposed a 3-layer architecture instead of the traditional 2-layer architecture by introducing a CloudSec module that allows the encryption of data in transit using the HTTPS/Secure Socket Layer. The CloudSec module also allows for restricting access to the data and detecting the misuse of cloud resources by using an access control mechanism. In a work performed by (Sicuranza and Paragliola, 2020) in , they proposed a hybrid IDS for cyber-attack detection against EHR. The proposed system uses agents deployed within the monitored IT infrastructure. They are responsible for collecting, normalizing, and performing security analysis on the logs collected from the local level. Then these agents generate events that are sent to the IDS for analysis. The IDS comprises a misuse detection module and an anomaly detection module. The misuse detection module is rule-based, effectively detecting the well-known attack signature. The anomaly detection module allows the detection of zero-day attacks. Anomaly detection uses three classifiers: DT, Neural Network, and k-means. The results of these classifiers are sent to the voting system to improve the accuracy of each classifier. In addition, an expert system module is designed to resolve any potential conflict between the presence/absence of attacks as determined by the abuse detection module and the anomaly detection voting system. A dataset was generated by monitoring the Italian EHR system to test the proposed model. Three separate attacks on the EHR systems were used to test the misuse and anomaly detection modules. The results demonstrate the efficiency of the proposed solution. In addition, in a study reported by (McGlade and Scott-Hayward, 2019) in , they proposed a framework for detecting privacy and availability issues in EMR systems. The framework is based on ML and uses the SVM to detect privacy-related incidents and the Exponential Moving Average (EMA) to detect anomalies in message flow that may cause a denial of service. To test the framework, the authors have used synthetic data generated by the Synthea tool (113), a synthetic patient population simulator. They have tested three ML algorithms on the dataset, namely SVM, KNN, and multinomial NB, to detect anomaly-related to the confidentiality of the EMR system and EMA for the detection of anomaly-related to the availability of the EMR system. After performing different tests, the authors found that SVM exhibits the best performance regarding accuracy and recall than the two other methods. They also find that EMA can successfully detect message surges, leading to a denial of services. EHRs and EMRs are critical systems for storing sensitive patient information. Ensuring this information's confidentiality, integrity, and availability are of utmost importance. The literature review reveals that most studies have concentrated on detecting unauthorized access to EHRs . Only one study has focused on the confidentiality and availability of EMRs . However, there is a need for further research in ML to ensure the integrity of both EHRs and EMRs. Exploration in this area holds great promise and could be a valuable direction for future investigation.

CHALLENGES AND LIMITATIONS The exploration of the different solutions proposed in the literature using IDS based on ML for IoMT led us to identify the limitations and challenges of this approach at the different layers that compose IoMT as follows:

Data Collection Level Security The deployment of ML models in medical equipment presents a challenge due to its various limitations. Three methods of deployment have been proposed, which include deployment of the ML model on medical equipment , deployment on a third-party device , or deployment on a chip followed by integration into the medical equipment . The deployment of ML models on resource-constrained medical devices can have consequences such as shortened battery life, which may require surgery for battery replacement and pose a risk to the patient. Deployment on thirdparty devices involves communication between the devices and medical equipment, which requires a modification at the software level of the medical device. However, medical device manufacturers do not permit such changes, and third-party devices must also be protected from potential attacks. Deployment on a chip and integration into the medical device involves software and hardware modifications. Lightweight ML models that satisfy the limitations of sensors may be a promising area of research in addressing the challenge of deploying ML models on resource-limited medical devices. Additionally, the ML model must be secured to prevent data manipulation during the learning or testing phase that can compromise the results . Detecting anomalies in medical data can arise from various factors, including poor communication quality due to interference or malfunctioning sensors, medical emergencies that result in severe illness, and security attacks carried out by malicious entities. It is crucial to differentiate between these various sources of anomalies, as prompt identification and treatment are necessary for emergencies. The limited availability of public datasets generated explicitly for security purposes and containing medical data presents a challenge for researchers. Some have resorted to using existing medical datasets, such as PHYSIONET (100), and modified specific values with the help of healthcare professionals to simulate attacks, leading to questions about the validity of their findings when applied in real-world scenarios. Other studies have used real medical equipment volunteers wear to collect health data. However, these results may need to be more representative as the volunteers may not have any underlying health conditions. Using simulators, such as CASTILIA , to generate medical data and attacks can also result in unforeseen difficulties during practical implementation. The acquisition of a high-quality, diverse, and representative dataset containing medical data collected from individuals with and without illnesses, and generated explicitly for security purposes, remains a significant challenge. Another limitation is that the various IDSs proposed in the literature focus on a restricted number of medical devices to generate a medical dataset. However, when patients utilize multiple medical devices, it becomes imperative to have integrated solutions to detect intrusions from these different medical devices. The challenge lies in designing an IDS solution that can accommodate all connected medical devices, as each has specific data collection and communication methods. Some solutions rely on the patient's ability to determine the occurrence of an attack. However, this approach needs to consider potential limitations such as age, incapacity, or emergency circumstances where the patient may be unable to make such a decision. Establishing effective protocols for communication and decision-making in the event of anomalous behavior detection poses a challenge. The study has demonstrated that rule-based solutions for anomaly detection in medical data may achieve better results than ML-based anomaly detection systems because some medical attributes contain a range of values that, if exceeded, can be easily detected by implementing clear and defined rules. On the other hand, ML-based anomaly detection can detect anomalies by analyzing correlations between multiple medical attributes. This highlights the need for a comprehensive evaluation of rule-based and ML-based anomaly detection methods to determine their strengths and limitations in detecting anomalies in medical data. Further research should consider this aspect to improve the accuracy and reliability of anomaly detection in medical data. The generalizability of a ML model constructed from a specific patient's medical dataset is limited, as what may be considered abnormal medical values for one patient may be considered normal for another patient . Ensuring the accuracy of the ML models when applied to different patient populations with varying medical conditions and characteristics remains a challenge.

Transmission Level Security In developing a Network-based IDS for the IoMT, the unique characteristics of the IoMT system must be considered, such as its distributed, mobile, dynamic nature and heterogeneous communication constraints. When designing an ML-based Network-based IDS for IoMT security, it is essential to consider the evaluation metrics for the ML model, especially when the dataset is imbalanced. The use of metrics that give higher importance to the minority classes and accurately reflect the ability of the ML model to detect attacks is imperative, as the IDS is responsible for protecting the essential information system against security threats. However, implementing an ML model with an imbalanced dataset presents challenges such as biased results, overfitting, and difficulties in evaluating performance using traditional metrics. When developing the ML model, it is necessary to handle the imbalanced nature of the dataset carefully. A real-time detection system in the IoMT using ML is crucial for prompt and adequate decision-making in the event of security threats. However, implementing such a system presents several technical challenges, including the efficient and accurate processing of a large volume of data generated by the IoMT system, ensuring a high level of accuracy in the ML model's detection of attacks, and low latency in processing and prediction. The system must also be scalable and have the hardware capabilities to support the ML model and handle large amounts of data in real-time. The use of black-box models in applications like healthcare is limited due to regulations, such as the General Data Protection Regulation, which prohibits automated decisions in critical sectors. Despite their widespread use in other applications, black-box models present significant challenges, including a lack of transparency, making it difficult to understand how the model arrived at its predictions and identify potential biases. Explaining the model's decisions is also a significant challenge, especially in applications where justifiable decisions are indispensable. Black-box models can also be vulnerable to adversarial attacks and have limited interpretability, making it challenging to debug and finetune the model to improve its performance. Explainable artificial intelligence (XAI) has become increasingly popular in addressing these challenges. XAI allows for creation of models that can be interpreted, understood, and transparent, and the reasoning behind their decisions can be easily explained. By using XAI, the limitations of black-box models can be overcome, promoting responsible AI development and deployment, improving trust in the model, and increasing accountability. Implementing a real-time detection system for the IoMT using ML requires using a dataset that accurately represents the IoMT system. The utilization of datasets not designed explicitly for the IoMT system may result in a limited representation of the system and its potential attack scenarios, hindering the ability of the ML model to detect attacks effectively in real-world situations. Obtaining a comprehensive dataset encompassing the diverse range of attacks and communication protocols within the IoMT system remains challenging. The IoMT system requires effective IDS to ensure the safety and security of medical data. Various architectures have been proposed to support these requirements, including centralized, distributed, fog-cloud and federated solutions. While centralized solutions, such as SDN, offer a centralized control point, they also pose challenges, such as the risk of a single point of failure, increased latency, and privacy concerns. Distributed solutions present a unique approach, but the practical deployment of these solutions in real-world situations still needs to be improved . The use of a fogcloud architecture presents a promising approach. However, the challenge of submerged data flow must be addressed in this architecture. On the other hand, federated solutions must consider the risk of adversarial attacks during the model-sharing process.

Storage Level Security The concept of IDS in the medical server encounters several challenges and limitations. The data structure and format utilized for training the ML model within the medical server are distinct from other servers, making it challenging to extend the model's applicability to other medical institutions. A large amount of unlabeled data for supervised learning processes presents a significant obstacle for ML practitioners. The lack of labeled data makes it challenging to train the model effectively. The manual data labeling process, which often requires an interview with the patient to ensure correct labeling, can be both time-consuming and resourceintensive. Notably, this manual labeling process and the need for patient interaction result in intrusion detection at the medical server level is not fully automated. Therefore, unsupervised or semi-supervised ML methods should be further investigated at this level with particular attention to reducing false positives. The possibility of a malicious actor altering a single feature value within an EHR or EMR for a single patient poses a challenge for ML models trained on a large amount of medical data . These models typically rely on identifying patterns within the data and are designed to detect larger deviations from these patterns, making it difficult for the models to detect a single, subtle change in a feature value. Such an attack could have significant consequences, particularly in a medical context where patient data integrity is vital. Measures must be taken to address this challenge, such as utilizing more sophisticated ML models that can detect single-value changes or augmenting the training data with a diverse range of feature changes to enhance the model's ability to identify such modifications. The difficulty in obtaining public medical data in the form of EMRs or EHRs results from such data's sensitivity and confidentiality. The privacy and security of patients and medical information are of utmost importance. Therefore, the release of such data is often heavily regulated and subject to strict privacy laws and regulations. This presents a significant challenge for those seeking to use the data for research or analysis purposes, as access to a large and diverse sample of medical data is critical for developing and training ML models.

CONCLUSION A comprehensive survey on how to use an IDS-based ML to secure the IoMT is conducted. For this purpose, the generic architecture of IoMT, which is divided into three layers (data acquisition layer, personal server layer, and medical server layer) is presented. Then the requirements and possible threats that can affect the security of IoMT are provided. Next, the ML-based solutions for IoMT security are reviewed and categorized into three levels: data collection level, transmission level, and storage level, indicating the advantages, disadvantages, and datasets used. Finally, the challenges and limitations of using ML in these categories are discussed. This survey aims to highlight ML ability to bring security to complex infrastructures such as IoMT and the capacity to comply with the particular constraints of IoMT. The main limitations of this survey are as follows: (i) The literature survey that is the subject of this study may have unintentionally left out the most current non-scientific developments or academic works that were not yet published at the time of the investigation. (ii) Although every attempt has been made to provide background, this research includes several concepts that may need to be referred to additional sources for a complete comprehension. (iii) It is noteworthy that our recommendations are inherently subjective. We intend to encourage additional research and discussion to address these limitations.

Declaration of Competing Interest The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.